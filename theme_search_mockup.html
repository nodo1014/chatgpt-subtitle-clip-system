<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ Theme Search - í…Œë§ˆë³„ ë‹¤ì¤‘ ë¬¸ì¥ ê²€ìƒ‰ ì‹œìŠ¤í…œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #0f0f23;
            min-height: 100vh;
            color: #ececf1;
            margin: 0;
            padding: 0;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }
        
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
            background: #0f0f23;
            transition: all 0.3s ease;
        }

        /* ChatGPT Style Sidebar */
        .sidebar {
            width: 260px;
            background: #171717;
            color: #ececf1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #2d2d2d;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar.collapsed {
            width: 0;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid #2d2d2d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-toggle {
            background: transparent;
            border: 1px solid #2d2d2d;
            color: #ececf1;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sidebar-toggle:hover {
            background: #2d2d2d;
        }

        .new-chat-btn {
            flex: 1;
            background: transparent;
            border: 1px solid #2d2d2d;
            color: #ececf1;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-right: 8px;
        }

        .new-chat-btn:hover {
            background: #2d2d2d;
        }

        .sidebar-content {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            max-height: calc(100vh - 80px);
        }

        .search-history {
            margin-bottom: 24px;
        }
        
        .search-history:last-child {
            margin-bottom: 0;
        }

        .search-history h3 {
            font-size: 0.8rem;
            color: #8e8ea0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .history-item {
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 2px;
            font-size: 0.9rem;
            line-height: 1.3;
            color: #e5e5e5;
        }

        .history-item:hover {
            background: #2d2d2d;
        }

        .history-item.active {
            background: #343541;
        }

        /* Main Content Area */
        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .main-header {
            background: white;
            border-bottom: 1px solid #e5e5e5;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 60px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mobile-sidebar-toggle {
            background: transparent;
            border: 1px solid #e5e5e5;
            color: #333;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }

        .mobile-sidebar-toggle:hover {
            background: #f5f5f5;
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-stats {
            display: flex;
            gap: 20px;
            font-size: 0.8rem;
            color: #666;
        }

        .stat-badge {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            color: #333;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        /* Search Input Section - Main page style */
        .search-input-section {
            background: white;
            padding: 40px 30px 30px 30px;
            border-bottom: 1px solid #e5e5e5;
            flex-shrink: 0;
        }



        /* Search Input Area - Updated for main page only */
        .search-input-area {
            background: white;
            padding: 40px 30px;
            color: #333;
            border-bottom: 1px solid #e5e5e5;
        }

        .search-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .search-section h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 12px;
            text-align: center;
            color: #333;
        }

        .search-description {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.8;
            line-height: 1.5;
            color: #666;
        }

        .batch-input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e5e5e5;
        }

        .input-label {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .batch-text-input {
            width: 100%;
            min-height: 160px;
            padding: 15px;
            border: 1px solid #e5e5e5;
            border-radius: 10px;
            background: white;
            color: #333;
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }

        .batch-text-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 1px #007bff;
        }

        .batch-text-input::placeholder {
            color: #999;
            font-style: italic;
        }

        .search-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .option-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-label {
            font-size: 0.9rem;
            color: #333;
            font-weight: 500;
        }

        .option-select {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            padding: 8px 12px;
            color: #333;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-select:focus {
            outline: none;
            border-color: #007bff;
        }

        .search-actions {
            display: flex;
            gap: 12px;
        }

        .search-btn {
            background: #007bff;
            color: white;
            border: 1px solid #007bff;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .search-btn:hover {
            background: #0056b3;
            border-color: #0056b3;
        }

        .search-btn.secondary {
            background: transparent;
            color: #666;
            border-color: #e5e5e5;
        }

        .search-btn.secondary:hover {
            background: #f5f5f5;
            color: #333;
        }

        /* Search Results - Updated for unified layout */
        .search-results {
            background: white;
            padding: 0 30px 30px 30px;
            overflow-y: auto;
            flex: 1;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px 0 15px 0;
            border-bottom: 1px solid #e5e5e5;
        }

        .results-count {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .view-toggle {
            display: flex;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 4px;
        }

        .view-btn {
            background: none;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #666;
        }

        .view-btn.active {
            background: #007bff;
            color: white;
        }

        .theme-group {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .theme-group:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.15);
        }

        .theme-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .theme-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .theme-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 8px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            background: #e9ecef;
            border-color: #ccc;
        }

        .action-btn.primary {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .action-btn.primary:hover {
            background: #5a6fd8;
        }

        .sentences-grid {
            display: grid;
            gap: 15px;
        }

        .sentence-item {
            background: #f8f9ff;
            border: 1px solid #e8e8ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .sentence-item:hover {
            background: #f0f0ff;
            border-color: #667eea;
        }

        .sentence-english {
            font-size: 1rem;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .sentence-korean {
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
        }

        .sentence-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #888;
        }

        .sentence-source {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sentence-actions {
            display: flex;
            gap: 8px;
        }

        .sentence-action {
            background: none;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .sentence-action:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        /* Right Sidebar - Theme Board (hidden for ChatGPT style) */
        .theme-board {
            display: none;
        }

        .theme-board h2 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .saved-themes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .saved-theme {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .saved-theme:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .saved-theme.active {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .saved-theme-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .saved-theme-meta {
            font-size: 0.8rem;
            color: #666;
            display: flex;
            justify-content: space-between;
        }

        .quick-themes {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .quick-themes h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .quick-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 15px;
            margin-bottom: 10px;
            width: 100%;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .quick-theme:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* Batch Search Results Styles */
        .search-summary {
            background: #2d2d2d;
            color: #ececf1;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #343541;
        }

        .search-summary h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            color: #ececf1;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .summary-stats .stat-item {
            background: #343541;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #40414f;
        }

        .stat-label {
            display: block;
            font-size: 0.9rem;
            margin-bottom: 5px;
            opacity: 0.8;
            color: #8e8ea0;
        }

        .stat-value {
            display: block;
            font-size: 1.4rem;
            font-weight: 700;
            color: #ececf1;
        }

        .sentence-group {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #343541;
            transition: all 0.3s ease;
        }

        .sentence-group:hover {
            border-color: #10a37f;
        }

        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #343541;
        }

        .sentence-header h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin: 0;
            flex: 1;
            margin-right: 15px;
        }

        .result-count {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .sentence-results {
            display: grid;
            gap: 12px;
        }

        .result-card {
            background: #f8f9ff;
            border: 1px solid #e8e8ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            background: #f0f0ff;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.85rem;
        }

        .movie-title {
            font-weight: 600;
            color: #333;
        }

        .episode-info {
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            color: #666;
        }

        .timestamp {
            color: #888;
            font-family: monospace;
        }

        .confidence {
            color: #667eea;
            font-weight: 600;
        }

        .result-content {
            margin: 10px 0;
        }

        .subtitle-text {
            font-size: 1rem;
            color: #333;
            line-height: 1.5;
            margin: 0;
            font-style: italic;
        }

        .result-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .result-actions .action-btn {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .result-actions .action-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .result-actions .action-btn.play:hover {
            background: #28a745;
            border-color: #28a745;
        }

        .result-actions .action-btn.clip:hover {
            background: #ffc107;
            border-color: #ffc107;
            color: #333;
        }

        .result-actions .action-btn.save:hover {
            background: #17a2b8;
            border-color: #17a2b8;
        }

        /* Loading and Empty States */
        .loading {
            text-align: center;
            padding: 50px;
            color: #8e8ea0;
        }

        .empty-state {
            text-align: center;
            padding: 50px;
            color: #8e8ea0;
        }

        .empty-state h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #ececf1;
        }

        /* Progress Indicators */
        .progress-bar {
            width: 100%;
            height: 4px;
            background: #f0f0f0;
            border-radius: 2px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #0056b3);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }
            
            .search-input-area {
                padding: 30px 20px;
            }
            
            .search-input-section {
                padding: 30px 20px 20px 20px;
            }
            
            .search-options {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .search-actions {
                justify-content: center;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar:not(.collapsed) {
                transform: translateX(0);
            }
            
            .sidebar.collapsed {
                transform: translateX(-100%);
            }
            
            .mobile-sidebar-toggle {
                display: flex;
            }
            
            .main-area {
                width: 100%;
            }
            
            .search-input-area {
                padding: 20px 15px;
            }
            
            .search-input-section {
                padding: 20px 15px 15px 15px;
            }
            
            .search-section h2 {
                font-size: 1.5rem;
            }
            
            .search-description {
                font-size: 1rem;
            }
            
            .batch-input-section {
                padding: 20px;
            }
            
            .batch-text-input {
                min-height: 120px;
                font-size: 0.9rem;
            }
            
            .search-actions {
                flex-direction: column;
            }
            
            .search-btn {
                width: 100%;
                justify-content: center;
            }
            
            .header-stats {
                display: none;
            }
            
            .search-results {
                padding: 15px;
            }
            
            /* Sidebar Overlay for Mobile */
            .sidebar-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
            }
            
            .sidebar-overlay.active {
                opacity: 1;
                visibility: visible;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .theme-group {
            animation: fadeInUp 0.6s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .search-btn:active {
            animation: pulse 0.3s ease;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ChatGPT Style Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <button class="new-chat-btn" onclick="startNewSearch()">
                    <span>â•</span>
                    <span>ìƒˆ í…Œë§ˆ ê²€ìƒ‰</span>
                </button>
            </div>
            
            <div class="sidebar-content">
                <div class="search-history">
                    <h3>ìµœê·¼ ê²€ìƒ‰</h3>
                    <div class="history-item active" onclick="loadHistoryItem('ğŸ’• ì‚¬ë‘ê³¼ ê´€ê³„ í‘œí˜„', 15)">
                        ğŸ’• ì‚¬ë‘ê³¼ ê´€ê³„ í‘œí˜„ (15ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ… ì˜ì–´', 12)">
                        ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ… ì˜ì–´ (12ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â˜• ì¼ìƒ ëŒ€í™” í‘œí˜„', 18)">
                        â˜• ì¼ìƒ ëŒ€í™” í‘œí˜„ (18ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ˜Š ê°ì • í‘œí˜„í•˜ê¸°', 20)">
                        ğŸ˜Š ê°ì • í‘œí˜„í•˜ê¸° (20ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ• ìŒì‹ ê´€ë ¨ í‘œí˜„', 16)">
                        ğŸ• ìŒì‹ ê´€ë ¨ í‘œí˜„ (16ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('âœˆï¸ ì—¬í–‰ ì˜ì–´ í‘œí˜„', 22)">
                        âœˆï¸ ì—¬í–‰ ì˜ì–´ í‘œí˜„ (22ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ“ í•™êµìƒí™œ í‘œí˜„', 14)">
                        ğŸ“ í•™êµìƒí™œ í‘œí˜„ (14ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ’ª ìš´ë™ê³¼ ê±´ê°•', 19)">
                        ğŸ’ª ìš´ë™ê³¼ ê±´ê°• (19ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ¬ ì˜í™” ë¦¬ë·° í‘œí˜„', 17)">
                        ğŸ¬ ì˜í™” ë¦¬ë·° í‘œí˜„ (17ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ›ï¸ ì‡¼í•‘ ì˜ì–´', 13)">
                        ğŸ›ï¸ ì‡¼í•‘ ì˜ì–´ (13ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ  ì§‘ì•ˆì¼ í‘œí˜„', 11)">
                        ğŸ  ì§‘ì•ˆì¼ í‘œí˜„ (11ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸš— êµí†µê³¼ ìš´ì „', 15)">
                        ğŸš— êµí†µê³¼ ìš´ì „ (15ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸ“± ê¸°ìˆ ê³¼ SNS', 21)">
                        ğŸ“± ê¸°ìˆ ê³¼ SNS (21ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸµ ìŒì•…ê³¼ ì·¨ë¯¸', 18)">
                        ğŸµ ìŒì•…ê³¼ ì·¨ë¯¸ (18ê°œ ë¬¸ì¥)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('ğŸŒ… ë‚ ì”¨ì™€ ê³„ì ˆ', 12)">
                        ğŸŒ… ë‚ ì”¨ì™€ ê³„ì ˆ (12ê°œ ë¬¸ì¥)
                    </div>
                </div>
                
                <div class="search-history">
                    <h3>ì¦ê²¨ì°¾ê¸°</h3>
                    <div class="history-item" onclick="loadHistoryItem('â­ TOEIC í•„ìˆ˜ í‘œí˜„', 45)">
                        â­ TOEIC í•„ìˆ˜ í‘œí˜„
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â­ ë©´ì ‘ ì˜ì–´ í‘œí˜„', 32)">
                        â­ ë©´ì ‘ ì˜ì–´ í‘œí˜„
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â­ ì¹œêµ¬ì™€ì˜ ëŒ€í™”', 28)">
                        â­ ì¹œêµ¬ì™€ì˜ ëŒ€í™”
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â­ í”„ë ˆì  í…Œì´ì…˜ ì˜ì–´', 36)">
                        â­ í”„ë ˆì  í…Œì´ì…˜ ì˜ì–´
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â­ ì´ë©”ì¼ ì‘ì„±ë²•', 24)">
                        â­ ì´ë©”ì¼ ì‘ì„±ë²•
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('â­ ì „í™” ì˜ì–´', 19)">
                        â­ ì „í™” ì˜ì–´
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Area -->
        <div class="main-area">
            <div class="main-header">
                <div class="header-left">
                    <button class="mobile-sidebar-toggle" onclick="toggleSidebar()" id="sidebarToggle">
                        <span>â˜°</span>
                    </button>
                    <div class="header-title">
                        ğŸ¯ Theme Search
                        <span style="font-size: 0.8rem; color: #666;">í…Œë§ˆë³„ ë‹¤ì¤‘ ë¬¸ì¥ ê²€ìƒ‰</span>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-badge">
                        <span>ğŸ“Š</span>
                        <span>270K+ ë¬¸ì¥</span>
                    </div>
                    <div class="stat-badge">
                        <span>ğŸ¬</span>
                        <span>7ê°œ ë¯¸ë””ì–´</span>
                    </div>
                    <div class="stat-badge">
                        <span>âš¡</span>
                        <span>AI ì¶”ì²œ</span>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <!-- Search Input Section Only -->
                <div class="search-input-section">
                    <div class="search-container">
                        <div class="search-section">
                            <h2>ğŸ¯ ë°°ì¹˜ ë¬¸ì¥ ê²€ìƒ‰</h2>
                            <p class="search-description">ì—¬ëŸ¬ ê°œì˜ ì˜ì–´ ë¬¸ì¥ì„ í•œ ë²ˆì— ì…ë ¥í•˜ì—¬ ê´€ë ¨ëœ ë¯¸ë””ì–´ ì½˜í…ì¸ ë¥¼ ì°¾ì•„ë³´ì„¸ìš”.</p>
                            
                            <div class="batch-input-section">
                                <label for="batchTextInput" class="input-label">
                                    ğŸ“ ì˜ì–´ ë¬¸ì¥ë“¤ ì…ë ¥ (í•œ ì¤„ì— í•˜ë‚˜ì”©)
                                </label>
                                <textarea 
                                    id="batchTextInput" 
                                    class="batch-text-input" 
                                    placeholder="I love you so much.
You make me happy.
How are you doing today?
Can you help me with this?
What do you think about it?

(ì˜ì–´ ë¬¸ì¥ì„ ì—¬ëŸ¬ ì¤„ë¡œ ì…ë ¥í•˜ì„¸ìš”. ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ê³  ë§ˆì¹¨í‘œë¡œ ëë‚˜ëŠ” ë¬¸ì¥ì„ ìë™ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.)"
                                    rows="6"></textarea>
                                
                                <div class="search-options">
                                    <div class="option-group">
                                        <label for="resultsPerSentence" class="option-label">ë¬¸ì¥ë‹¹ ê²°ê³¼ ìˆ˜:</label>
                                        <select id="resultsPerSentence" class="option-select">
                                            <option value="3">3ê°œ</option>
                                            <option value="5" selected>5ê°œ</option>
                                            <option value="10">10ê°œ</option>
                                            <option value="20">20ê°œ</option>
                                        </select>
                                    </div>
                                    
                                    <div class="search-actions">
                                        <button class="search-btn secondary" onclick="document.getElementById('batchTextInput').value = ''">
                                            ğŸ—‘ï¸ ì´ˆê¸°í™”
                                        </button>
                                        <button class="search-btn primary" onclick="performBatchSearch()">
                                            ğŸ” ë°°ì¹˜ ê²€ìƒ‰ ì‹œì‘
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="searchProgress" class="progress-bar" style="display: none;">
                                    <div class="progress-fill"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë°°ì¹˜ ë‹¤ì¤‘ ë¬¸ì¥ ê²€ìƒ‰ ê¸°ëŠ¥
        function extractEnglishSentences(text) {
            // í•œê¸€, í•œì, ì¼ë³¸ì–´ ë¬¸ì ì œê±° (ìœ ë‹ˆì½”ë“œ ë²”ìœ„)
            const koreanRegex = /[\u1100-\u11FF\u3130-\u318F\uAC00-\uD7AF\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF]/g;
            
            // 1ë‹¨ê³„: í•œê¸€/ì¤‘êµ­ì–´/ì¼ë³¸ì–´ ë¬¸ìê°€ í¬í•¨ëœ ì¤„ ì œê±°
            const lines = text.split('\n').filter(line => {
                const cleanLine = line.trim();
                return cleanLine.length > 0 && !koreanRegex.test(cleanLine);
            });
            
            // 2ë‹¨ê³„: ì˜ì–´ ë¬¸ì¥ ì¶”ì¶œ (ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ê³  .?!ë¡œ ëë‚˜ëŠ” ë¬¸ì¥)
            const sentences = [];
            const sentenceRegex = /[A-Z][^.!?]*[.!?]/g;
            
            lines.forEach(line => {
                const matches = line.match(sentenceRegex);
                if (matches) {
                    matches.forEach(sentence => {
                        const trimmed = sentence.trim();
                        // ìµœì†Œ ê¸¸ì´ ì²´í¬ (ë„ˆë¬´ ì§§ì€ ë¬¸ì¥ ì œì™¸)
                        if (trimmed.length >= 10 && trimmed.split(' ').length >= 3) {
                            sentences.push(trimmed);
                        }
                    });
                }
            });
            
            return sentences;
        }

        function simulateBatchSearch(sentences, resultsPerSentence) {
            const allResults = [];
            let totalFound = 0;
            
            sentences.forEach((sentence, index) => {
                // ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ê²€ìƒ‰ ì‹œë®¬ë ˆì´ì…˜
                const mockResults = generateMockSearchResults(sentence, resultsPerSentence);
                totalFound += mockResults.length;
                
                allResults.push({
                    searchSentence: sentence,
                    sentenceIndex: index + 1,
                    results: mockResults,
                    found: mockResults.length
                });
            });
            
            return {
                searchedSentences: sentences.length,
                totalResults: totalFound,
                avgPerSentence: (totalFound / sentences.length).toFixed(1),
                results: allResults
            };
        }

        function generateMockSearchResults(sentence, count) {
            const mockData = [
                { movie: "The Office", season: 3, episode: 14, time: "12:34", context: sentence, confidence: 0.95 },
                { movie: "Friends", season: 10, episode: 2, time: "08:22", context: sentence, confidence: 0.89 },
                { movie: "Breaking Bad", season: 2, episode: 7, time: "35:18", context: sentence, confidence: 0.84 },
                { movie: "Stranger Things", season: 1, episode: 4, time: "22:45", context: sentence, confidence: 0.78 },
                { movie: "The Crown", season: 4, episode: 8, time: "41:12", context: sentence, confidence: 0.72 },
                { movie: "Sherlock", season: 2, episode: 1, time: "15:30", context: sentence, confidence: 0.69 },
                { movie: "House of Cards", season: 3, episode: 5, time: "28:56", context: sentence, confidence: 0.65 },
                { movie: "Black Mirror", season: 4, episode: 6, time: "33:21", context: sentence, confidence: 0.61 },
                { movie: "Westworld", season: 1, episode: 9, time: "45:18", context: sentence, confidence: 0.58 },
                { movie: "Game of Thrones", season: 7, episode: 3, time: "52:14", context: sentence, confidence: 0.54 }
            ];
            
            return mockData.slice(0, Math.min(count, mockData.length));
        }

        function performBatchSearch() {
            const batchText = document.getElementById('batchTextInput').value.trim();
            const resultsPerSentence = parseInt(document.getElementById('resultsPerSentence').value);
            
            if (!batchText) {
                alert('ë‹¤ì¤‘ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            showSearchProgress();
            
            // ì‹¤ì œ API í˜¸ì¶œ
            fetch('/api/batch-search', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    text: batchText,
                    results_per_sentence: resultsPerSentence
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
                    addToSearchHistory(data.extracted_sentences, data.search_summary.total_results);
                    
                    // ìƒˆ í˜ì´ì§€ë¡œ ê²°ê³¼ ì „ë‹¬
                    redirectToResults(data);
                } else {
                    alert(data.error || 'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    // ë°±ì—…ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰
                    performBatchSearchSimulation();
                }
                hideSearchProgress();
            })
            .catch(error => {
                console.error('API í˜¸ì¶œ ì˜¤ë¥˜:', error);
                // ChatGPTì²˜ëŸ¼ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ë°”ë¡œ ì´ë™
                performBatchSearchSimulation();
                hideSearchProgress();
            });
        }

        function performBatchSearchSimulation() {
            const batchText = document.getElementById('batchTextInput').value.trim();
            const resultsPerSentence = parseInt(document.getElementById('resultsPerSentence').value);
            
            // ì˜ì–´ ë¬¸ì¥ ì¶”ì¶œ
            const englishSentences = extractEnglishSentences(batchText);
            
            if (englishSentences.length === 0) {
                alert('ì˜ì–´ ë¬¸ì¥ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ê³  ë§ˆì¹¨í‘œë¡œ ëë‚˜ëŠ” ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë°°ì¹˜ ê²€ìƒ‰ ì‹¤í–‰ (ì‹œë®¬ë ˆì´ì…˜)
            const searchResults = simulateBatchSearch(englishSentences, resultsPerSentence);
            
            // ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
            addToSearchHistory(englishSentences, searchResults.totalResults);
            
            // ê²°ê³¼ ë°ì´í„° ìƒì„±
            const resultsData = {
                success: true,
                extracted_sentences: englishSentences,
                search_summary: {
                    total_sentences: searchResults.searchedSentences,
                    total_results: searchResults.totalResults,
                    average_per_sentence: searchResults.avgPerSentence,
                    search_time: 1.2
                },
                sentence_results: searchResults.results.map(r => ({
                    sentence_index: r.sentenceIndex,
                    search_sentence: r.searchSentence,
                    found_count: r.found,
                    results: r.results.map(result => ({
                        media_name: result.movie,
                        subtitle_text: result.context,
                        timestamp: result.time,
                        confidence: result.confidence,
                        file_path: `/${result.movie.toLowerCase().replace(' ', '_')}/s${result.season}e${result.episode}.srt`
                    }))
                }))
            };
            
            // ìƒˆ í˜ì´ì§€ë¡œ ê²°ê³¼ ì „ë‹¬
            redirectToResults(resultsData);
        }

        function addToSearchHistory(sentences, totalResults) {
            const historyItem = {
                timestamp: new Date().toLocaleString('ko-KR'),
                sentences: sentences,
                sentenceCount: sentences.length,
                totalResults: totalResults,
                type: 'batch'
            };
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë°±ì—”ë“œ API í˜¸ì¶œ)
            let searchHistory = JSON.parse(localStorage.getItem('batchSearchHistory') || '[]');
            searchHistory.unshift(historyItem);
            searchHistory = searchHistory.slice(0, 10); // ìµœê·¼ 10ê°œë§Œ ìœ ì§€
            localStorage.setItem('batchSearchHistory', JSON.stringify(searchHistory));
            
            console.log('ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€ë¨:', historyItem);
        }

        // ìƒˆ ê²€ìƒ‰ ì‹œì‘
        function startNewSearch() {
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('batchTextInput').value = '';
            
            // ì‚¬ì´ë“œë°”ì˜ í™œì„± í•­ëª© ì œê±°
            document.querySelectorAll('.history-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        // í€µ ê²€ìƒ‰ ê¸°ëŠ¥ ê°œì„ 
        function quickSearch(themeType) {
            const themeData = {
                'love': {
                    title: 'ğŸ’• ì‚¬ë‘ê³¼ ê´€ê³„',
                    sentences: [
                        'I love you more than words can express.',
                        'You make me want to be a better person.',
                        'I can\'t imagine my life without you.',
                        'You complete me.',
                        'I\'m crazy about you.'
                    ]
                },
                'business': {
                    title: 'ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì–´',
                    sentences: [
                        'Let\'s schedule a meeting to discuss this further.',
                        'I need the quarterly reports by tomorrow.',
                        'We should consider all our options.',
                        'Could you please send me the agenda?',
                        'I\'d like to propose a new strategy.'
                    ]
                },
                'daily': {
                    title: 'â˜• ì¼ìƒ ëŒ€í™”',
                    sentences: [
                        'How was your day?',
                        'What do you want for dinner?',
                        'I\'m running late for work.',
                        'The weather is really nice today.',
                        'Did you watch the news last night?'
                    ]
                }
            };
            
            const theme = themeData[themeType];
            if (!theme) return;
            
            // ë¡œë”© í‘œì‹œ
            showSearchProgress();
            
            // ì‹œë®¬ë ˆì´ì…˜ ì§€ì—° í›„ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
            setTimeout(() => {
                // í€µ ê²€ìƒ‰ ê²°ê³¼ ë°ì´í„° ìƒì„±
                const mockResults = theme.sentences.map((sentence, index) => ({
                    sentence_index: index + 1,
                    search_sentence: sentence,
                    found_count: 3 + Math.floor(Math.random() * 3),
                    results: generateMockSearchResults(sentence, 3)
                }));
                
                const resultsData = {
                    success: true,
                    extracted_sentences: theme.sentences,
                    search_summary: {
                        total_sentences: theme.sentences.length,
                        total_results: mockResults.reduce((sum, r) => sum + r.found_count, 0),
                        average_per_sentence: (mockResults.reduce((sum, r) => sum + r.found_count, 0) / theme.sentences.length).toFixed(1),
                        search_time: 0.8
                    },
                    sentence_results: mockResults.map(r => ({
                        sentence_index: r.sentence_index,
                        search_sentence: r.search_sentence,
                        found_count: r.found_count,
                        results: r.results.map(result => ({
                            media_name: result.movie,
                            subtitle_text: result.context,
                            timestamp: result.time,
                            confidence: result.confidence,
                            file_path: `/${result.movie.toLowerCase().replace(' ', '_')}/s${result.season}e${result.episode}.srt`
                        }))
                    }))
                };
                
                // ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
                addToSearchHistory(theme.sentences, resultsData.search_summary.total_results);
                
                // ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
                redirectToResults(resultsData);
                hideSearchProgress();
            }, 1000);
        }

        // Sample data for demonstration
        const sampleThemes = {
            'love-relationship': {
                title: 'ğŸ’• ì‚¬ë‘ê³¼ ê´€ê³„',
                count: 15,
                sentences: [
                    {
                        english: "I love you more than words can express.",
                        korean: "ë§ë¡œ í‘œí˜„í•  ìˆ˜ ì—†ì„ ë§Œí¼ ë‹¹ì‹ ì„ ì‚¬ë‘í•´ìš”.",
                        source: "The Notebook",
                        timestamp: "01:23:45"
                    },
                    {
                        english: "You make me want to be a better person.",
                        korean: "ë‹¹ì‹ ì€ ë‚˜ë¥¼ ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ê²Œ ë§Œë“¤ì–´ìš”.",
                        source: "As Good as It Gets",
                        timestamp: "02:15:30"
                    },
                    {
                        english: "I can't imagine my life without you.",
                        korean: "ë‹¹ì‹  ì—†ëŠ” ë‚´ ì¸ìƒì€ ìƒìƒí•  ìˆ˜ ì—†ì–´ìš”.",
                        source: "Friends S02E07",
                        timestamp: "00:18:22"
                    }
                ]
            },
            'emotions': {
                title: 'ğŸ˜Š ê°ì • í‘œí˜„',
                count: 20,
                sentences: [
                    {
                        english: "I'm feeling overwhelmed right now.",
                        korean: "ì§€ê¸ˆ ë„ˆë¬´ ë²…ì°¨ëŠ” ê¸°ë¶„ì´ì—ìš”.",
                        source: "This Is Us S01E03",
                        timestamp: "00:25:18"
                    },
                    {
                        english: "That made me incredibly happy.",
                        korean: "ê·¸ê²ƒì´ ë‚˜ë¥¼ ì—„ì²­ë‚˜ê²Œ í–‰ë³µí•˜ê²Œ í–ˆì–´ìš”.",
                        source: "Friends S05E14",
                        timestamp: "00:12:45"
                    },
                    {
                        english: "I'm really nervous about the presentation.",
                        korean: "ë°œí‘œ ë•Œë¬¸ì— ì •ë§ ê¸´ì¥ë¼ìš”.",
                        source: "The Office S03E12",
                        timestamp: "00:08:33"
                    }
                ]
            }
        };

        // Search functionality
        function handleSearchKeyPress(event) {
            if (event.key === 'Enter') {
                addSearchTag();
            }
        }

        function addSearchTag() {
            const input = document.getElementById('themeSearch');
            const tag = input.value.trim();
            
            if (tag && !currentSearchTags.includes(tag)) {
                currentSearchTags.push(tag);
                input.value = '';
                updateSearchTags();
            }
        }

        function updateSearchTags() {
            const container = document.getElementById('searchTags');
            container.innerHTML = '';
            
            currentSearchTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'search-tag';
                tagElement.innerHTML = `
                    <span>${tag}</span>
                    <span class="remove-tag" onclick="removeSearchTag('${tag}')">Ã—</span>
                `;
                container.appendChild(tagElement);
            });
        }

        function removeSearchTag(tag) {
            currentSearchTags = currentSearchTags.filter(t => t !== tag);
            updateSearchTags();
        }

        function toggleFilter(button, filter) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }

        function performThemeSearch() {
            if (isSearching) return;
            
            isSearching = true;
            showSearchProgress();
            
            // Simulate API call
            setTimeout(() => {
                displaySearchResults();
                hideSearchProgress();
                isSearching = false;
            }, 2000);
        }

        function showSearchProgress() {
            const progressBar = document.getElementById('searchProgress');
            progressBar.style.display = 'block';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.querySelector('.progress-fill').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 200);
        }

        function hideSearchProgress() {
            setTimeout(() => {
                document.getElementById('searchProgress').style.display = 'none';
                document.querySelector('.progress-fill').style.width = '0%';
            }, 500);
        }

        function displaySearchResults() {
            const container = document.getElementById('searchResultsContainer');
            const resultsCount = document.getElementById('resultsCount');
            
            // Generate results based on search tags
            const themes = generateThemeResults();
            currentThemes = themes;
            
            resultsCount.textContent = `ğŸ¯ ${themes.length}ê°œ í…Œë§ˆ, ì´ ${themes.reduce((sum, theme) => sum + theme.count, 0)}ê°œ ë¬¸ì¥ ë°œê²¬`;
            
            container.innerHTML = '';
            
            themes.forEach((theme, index) => {
                const themeElement = createThemeElement(theme, index);
                container.appendChild(themeElement);
            });
        }

        function generateThemeResults() {
            // Simulate theme generation based on search tags
            const themes = [];
            
            if (currentSearchTags.includes('love') || currentSearchTags.includes('relationship')) {
                themes.push({
                    id: 'love-relationship',
                    title: 'ğŸ’• ì‚¬ë‘ê³¼ ê´€ê³„',
                    count: 15,
                    category: 'romance',
                    difficulty: 'intermediate',
                    sources: ['Friends', 'The Notebook', 'When Harry Met Sally'],
                    sentences: generateSampleSentences('love', 15)
                });
            }
            
            if (currentSearchTags.includes('work') || currentSearchTags.includes('business')) {
                themes.push({
                    id: 'business-work',
                    title: 'ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ì—…ë¬´',
                    count: 12,
                    category: 'business',
                    difficulty: 'advanced',
                    sources: ['The Office', 'Mad Men', 'Suits'],
                    sentences: generateSampleSentences('business', 12)
                });
            }
            
            if (currentSearchTags.includes('friend') || currentSearchTags.includes('friendship')) {
                themes.push({
                    id: 'friendship',
                    title: 'ğŸ‘¥ ìš°ì •ê³¼ ë™ë£Œ',
                    count: 18,
                    category: 'friendship',
                    difficulty: 'intermediate',
                    sources: ['Friends', 'How I Met Your Mother', 'The Big Bang Theory'],
                    sentences: generateSampleSentences('friendship', 18)
                });
            }
            
            // Default themes if no specific tags
            if (themes.length === 0) {
                themes.push({
                    id: 'daily-conversation',
                    title: 'â˜• ì¼ìƒ ëŒ€í™”',
                    count: 20,
                    category: 'daily',
                    difficulty: 'beginner',
                    sources: ['Friends', 'Modern Family', 'The Office'],
                    sentences: generateSampleSentences('daily', 20)
                });
            }
            
            return themes;
        }

        function generateSampleSentences(category, count) {
            const sentences = {
                love: [
                    { english: "I love you more than words can express.", korean: "ë§ë¡œ í‘œí˜„í•  ìˆ˜ ì—†ì„ ë§Œí¼ ë‹¹ì‹ ì„ ì‚¬ë‘í•´ìš”.", source: "The Notebook", timestamp: "01:23:45" },
                    { english: "You make me want to be a better person.", korean: "ë‹¹ì‹ ì€ ë‚˜ë¥¼ ë” ë‚˜ì€ ì‚¬ëŒì´ ë˜ê³  ì‹¶ê²Œ ë§Œë“¤ì–´ìš”.", source: "As Good as It Gets", timestamp: "02:15:30" },
                    { english: "I can't imagine my life without you.", korean: "ë‹¹ì‹  ì—†ëŠ” ë‚´ ì¸ìƒì€ ìƒìƒí•  ìˆ˜ ì—†ì–´ìš”.", source: "Friends S02E07", timestamp: "00:18:22" }
                ],
                business: [
                    { english: "Let's schedule a meeting to discuss this further.", korean: "ì´ê²ƒì— ëŒ€í•´ ë” ë…¼ì˜í•˜ê¸° ìœ„í•´ íšŒì˜ë¥¼ ì¡ì•„ë´…ì‹œë‹¤.", source: "The Office S03E05", timestamp: "00:12:30" },
                    { english: "I need the quarterly reports by tomorrow.", korean: "ë‚´ì¼ê¹Œì§€ ë¶„ê¸° ë³´ê³ ì„œê°€ í•„ìš”í•©ë‹ˆë‹¤.", source: "Mad Men S02E08", timestamp: "00:25:15" },
                    { english: "We should consider all our options.", korean: "ëª¨ë“  ì„ íƒì‚¬í•­ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.", source: "Suits S01E12", timestamp: "00:18:45" }
                ],
                friendship: [
                    { english: "I'll always be there for you.", korean: "ì–¸ì œë‚˜ ë‹¹ì‹  ê³ì— ìˆì„ê²Œìš”.", source: "Friends S01E01", timestamp: "00:22:30" },
                    { english: "Thanks for being such a great friend.", korean: "ì´ë ‡ê²Œ ì¢‹ì€ ì¹œêµ¬ê°€ ë˜ì–´ì¤˜ì„œ ê³ ë§ˆì›Œìš”.", source: "How I Met Your Mother S03E15", timestamp: "00:19:20" },
                    { english: "We've been through so much together.", korean: "ìš°ë¦¬ëŠ” í•¨ê»˜ ë§ì€ ì¼ì„ ê²ªì–´ì™”ì–´ìš”.", source: "The Big Bang Theory S05E10", timestamp: "00:14:55" }
                ],
                daily: [
                    { english: "How was your day?", korean: "ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ì–´ìš”?", source: "Friends S01E02", timestamp: "00:05:30" },
                    { english: "What do you want for dinner?", korean: "ì €ë…ìœ¼ë¡œ ë­˜ ë“œì‹¤ë˜ìš”?", source: "Modern Family S02E15", timestamp: "00:08:45" },
                    { english: "I'm running late for work.", korean: "ì§ì¥ì— ëŠ¦ì„ ê²ƒ ê°™ì•„ìš”.", source: "The Office S01E01", timestamp: "00:03:20" }
                ]
            };
            
            return sentences[category] || sentences.daily;
        }

        function createThemeElement(theme, index) {
            const themeDiv = document.createElement('div');
            themeDiv.className = 'theme-group';
            themeDiv.style.animationDelay = (index * 0.1) + 's';
            
            themeDiv.innerHTML = `
                <div class="theme-header">
                    <div class="theme-title">
                        ${theme.title}
                        <span class="tooltip" data-tooltip="AIê°€ ë¶„ì„í•œ ${theme.count}ê°œ ê´€ë ¨ ë¬¸ì¥">â„¹ï¸</span>
                    </div>
                    <div class="theme-actions">
                        <button class="action-btn" onclick="saveTheme('${theme.id}')">
                            <span>ğŸ’¾</span>
                            <span>ì €ì¥</span>
                        </button>
                        <button class="action-btn" onclick="exportTheme('${theme.id}')">
                            <span>ğŸ“¤</span>
                            <span>ë‚´ë³´ë‚´ê¸°</span>
                        </button>
                        <button class="action-btn primary" onclick="startLearning('${theme.id}')">
                            <span>ğŸ¯</span>
                            <span>í•™ìŠµ ì‹œì‘</span>
                        </button>
                    </div>
                </div>
                
                <div class="theme-meta">
                    <div class="meta-item">
                        <span>ğŸ“Š</span>
                        <span>${theme.count}ê°œ ë¬¸ì¥</span>
                    </div>
                    <div class="meta-item">
                        <span>ğŸ“š</span>
                        <span>${theme.difficulty}</span>
                    </div>
                    <div class="meta-item">
                        <span>ğŸ¬</span>
                        <span>${theme.sources.length}ê°œ ì†ŒìŠ¤</span>
                    </div>
                    <div class="meta-item">
                        <span>â±ï¸</span>
                        <span>ì˜ˆìƒ í•™ìŠµì‹œê°„: ${Math.ceil(theme.count * 2.5)}ë¶„</span>
                    </div>
                </div>
                
                <div class="sentences-grid">
                    ${theme.sentences.slice(0, 3).map(sentence => `
                        <div class="sentence-item">
                            <div class="sentence-english">"${sentence.english}"</div>
                            <div class="sentence-korean">"${sentence.korean}"</div>
                            <div class="sentence-meta">
                                <div class="sentence-source">
                                    <span>ğŸ¬</span>
                                    <span>${sentence.source}</span>
                                    <span>â€¢</span>
                                    <span>${sentence.timestamp}</span>
                                </div>
                                <div class="sentence-actions">
                                    <button class="sentence-action" onclick="playAudio('${sentence.source}', '${sentence.timestamp}')">ğŸ”Š</button>
                                    <button class="sentence-action" onclick="addToFavorites('${sentence.english}')">â­</button>
                                    <button class="sentence-action" onclick="practiceThis('${sentence.english}')">ğŸ¯</button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    ${theme.count > 3 ? `
                        <div class="sentence-item" style="text-align: center; color: #667eea; font-weight: 600; cursor: pointer;" onclick="showAllSentences('${theme.id}')">
                            + ${theme.count - 3}ê°œ ë¬¸ì¥ ë” ë³´ê¸°
                        </div>
                    ` : ''}
                </div>
            `;
            
            return themeDiv;
        }

        function clearSearch() {
            currentSearchTags = [];
            document.getElementById('themeSearch').value = '';
            updateSearchTags();
            
            // Reset filters
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-btn').classList.add('active');
            
            // Clear results
            document.getElementById('searchResultsContainer').innerHTML = `
                <div class="empty-state">
                    <h3>ğŸ¯ í…Œë§ˆ ê²€ìƒ‰ì„ ì‹œì‘í•´ë³´ì„¸ìš”</h3>
                    <p>í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ë©´ ê´€ë ¨ëœ 10-20ê°œ ë¬¸ì¥ì„ í…Œë§ˆë³„ë¡œ ê·¸ë£¹í™”í•´ë“œë¦½ë‹ˆë‹¤.</p>
                    <p>ì˜ˆì‹œ: "love", "work", "friendship" ë“±</p>
                </div>
            `;
            
            document.getElementById('resultsCount').textContent = 'ê²€ìƒ‰ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...';
        }

        function switchView(viewType) {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // In a real implementation, this would change the layout
            console.log('Switching to', viewType, 'view');
        }

        // Theme Board Functions
        function loadTheme(themeId) {
            // Remove active class from all saved themes
            document.querySelectorAll('.saved-theme').forEach(theme => {
                theme.classList.remove('active');
            });
            
            // Add active class to clicked theme
            event.target.closest('.saved-theme').classList.add('active');
            
            // Load the theme data
            if (sampleThemes[themeId]) {
                const theme = sampleThemes[themeId];
                currentThemes = [theme];
                displayLoadedTheme(theme);
            }
        }

        function displayLoadedTheme(theme) {
            const container = document.getElementById('searchResultsContainer');
            const resultsCount = document.getElementById('resultsCount');
            
            resultsCount.textContent = `ğŸ“‹ ì €ì¥ëœ í…Œë§ˆ: ${theme.title} (${theme.count}ê°œ ë¬¸ì¥)`;
            
            container.innerHTML = '';
            const themeElement = createThemeElement({
                id: 'loaded-theme',
                title: theme.title,
                count: theme.count,
                category: 'saved',
                difficulty: 'mixed',
                sources: ['Multiple Sources'],
                sentences: theme.sentences
            }, 0);
            
            container.appendChild(themeElement);
        }

        function quickSearch(themeType) {
            currentSearchTags = [themeType];
            updateSearchTags();
            performThemeSearch();
        }

        // Action Functions
        function saveTheme(themeId) {
            alert(`í…Œë§ˆ "${themeId}"ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        function exportTheme(themeId) {
            alert(`í…Œë§ˆ "${themeId}"ë¥¼ ë‚´ë³´ë‚´ëŠ” ì¤‘... (CSV, JSON, í•™ìŠµìë£Œ í˜•íƒœë¡œ ê°€ëŠ¥)`);
        }

        function startLearning(themeId) {
            alert(`"${themeId}" í…Œë§ˆë¡œ í•™ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤! ì‰ë„ìœ™ ëª¨ë“œë¡œ ì „í™˜ë©ë‹ˆë‹¤.`);
        }

        function showAllSentences(themeId) {
            alert(`"${themeId}" í…Œë§ˆì˜ ëª¨ë“  ë¬¸ì¥ì„ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.`);
        }

        function playAudio(source, timestamp) {
            alert(`ğŸ”Š ${source} ${timestamp} ì˜¤ë””ì˜¤ë¥¼ ì¬ìƒí•©ë‹ˆë‹¤.`);
        }

        function addToFavorites(sentence) {
            alert(`â­ "${sentence}"ë¥¼ ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!`);
        }

        function practiceThis(sentence) {
            alert(`ğŸ¯ "${sentence}" ë¬¸ì¥ìœ¼ë¡œ ì‰ë„ìœ™ ì—°ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤!`);
        }

        // ì‚¬ì´ë“œë°” íˆìŠ¤í† ë¦¬ì— ìƒˆ í•­ëª© ì¶”ê°€
        function addToSidebarHistory(title, sentenceCount) {
            const historyContainer = document.querySelector('.search-history');
            const historyItems = historyContainer.querySelectorAll('.history-item');
            
            // ê¸°ì¡´ í™œì„± í•­ëª© ì œê±°
            historyItems.forEach(item => item.classList.remove('active'));
            
            // ìƒˆ í•­ëª© ìƒì„±
            const newItem = document.createElement('div');
            newItem.className = 'history-item active';
            newItem.textContent = `${title} (${sentenceCount}ê°œ ë¬¸ì¥)`;
            newItem.onclick = () => loadHistoryItem(title, sentenceCount);
            
            // ì²« ë²ˆì§¸ ìœ„ì¹˜ì— ì¶”ê°€ (h3 ë‹¤ìŒ)
            const h3 = historyContainer.querySelector('h3');
            h3.insertAdjacentElement('afterend', newItem);
            
            // 15ê°œ ì´ìƒì´ë©´ ë§ˆì§€ë§‰ í•­ëª© ì œê±°
            const allItems = historyContainer.querySelectorAll('.history-item');
            if (allItems.length > 15) {
                allItems[allItems.length - 1].remove();
            }
        }
        
        // íˆìŠ¤í† ë¦¬ í•­ëª© ë¡œë“œ
        function loadHistoryItem(title, sentenceCount) {
            // í™œì„± ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.history-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // í•´ë‹¹ ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ (ì‹œë®¬ë ˆì´ì…˜)
            document.getElementById('resultsCount').textContent = `ğŸ“‹ ì €ì¥ëœ ê²€ìƒ‰: ${title} (${sentenceCount}ê°œ ë¬¸ì¥)`;
            
            // ê°„ë‹¨í•œ ê²°ê³¼ í‘œì‹œ
            document.getElementById('searchResultsContainer').innerHTML = `
                <div style="text-align: center; padding: 50px; color: #8e8ea0;">
                    <div style="font-size: 2rem; margin-bottom: 20px;">ğŸ“</div>
                    <h3 style="color: #ececf1; margin-bottom: 15px;">${title}</h3>
                    <p>ì´ ${sentenceCount}ê°œì˜ ê´€ë ¨ ë¬¸ì¥ì´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
                    <p style="margin-top: 20px; opacity: 0.7;">ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì €ì¥ëœ ê²€ìƒ‰ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
                </div>
            `;
        }

        // ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
        function redirectToResults(data) {
            // ê²€ìƒ‰ ë°ì´í„°ë¥¼ URL íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
            const searchDataParam = encodeURIComponent(JSON.stringify(data));
            window.location.href = `search_results.html?data=${searchDataParam}`;
        }

        // ì‚¬ì´ë“œë°” í† ê¸€ ê¸°ëŠ¥
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            sidebar.classList.toggle('collapsed');
            
            // ëª¨ë°”ì¼ì—ì„œëŠ” ì˜¤ë²„ë ˆì´ ì¶”ê°€/ì œê±°
            if (window.innerWidth <= 768) {
                if (!sidebar.classList.contains('collapsed')) {
                    // ì˜¤ë²„ë ˆì´ ì¶”ê°€
                    const overlay = document.createElement('div');
                    overlay.className = 'sidebar-overlay';
                    overlay.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.5);
                        z-index: 999;
                        opacity: 0;
                        transition: opacity 0.3s ease;
                    `;
                    document.body.appendChild(overlay);
                    
                    // ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸°
                    overlay.onclick = toggleSidebar;
                    
                    // ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ ì•½ê°„ì˜ ì§€ì—°
                    setTimeout(() => {
                        overlay.style.opacity = '1';
                    }, 10);
                } else {
                    // ì˜¤ë²„ë ˆì´ ì œê±°
                    const overlay = document.querySelector('.sidebar-overlay');
                    if (overlay) {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            overlay.remove();
                        }, 300);
                    }
                }
            }
            
            // ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            if (sidebar.classList.contains('collapsed')) {
                sidebarToggle.innerHTML = '<span>â˜°</span>';
                sidebarToggle.title = 'ì‚¬ì´ë“œë°” ë³´ì´ê¸°';
            } else {
                sidebarToggle.innerHTML = '<span>â˜°</span>';
                sidebarToggle.title = 'ì‚¬ì´ë“œë°” ìˆ¨ê¸°ê¸°';
            }
        }

        // ì°½ í¬ê¸° ë³€ê²½ ì‹œ ì‚¬ì´ë“œë°” ìƒíƒœ ì²´í¬
        window.addEventListener('resize', function() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (window.innerWidth > 768) {
                // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ì˜¤ë²„ë ˆì´ ì œê±°
                if (overlay) {
                    overlay.remove();
                }
                // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ì‚¬ì´ë“œë°”ê°€ ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì„
                if (sidebar.classList.contains('collapsed')) {
                    sidebar.classList.remove('collapsed');
                }
            }
        });

        // ì´ˆê¸° ë¡œë“œ ì‹œ ëª¨ë°”ì¼ì—ì„œëŠ” ì‚¬ì´ë“œë°” ìˆ¨ê¹€
        document.addEventListener('DOMContentLoaded', function() {
            if (window.innerWidth <= 768) {
                const sidebar = document.querySelector('.sidebar');
                sidebar.classList.add('collapsed');
            }
        });

        // Global variables
        let currentSearchTags = [];
        let currentThemes = [];
        let isSearching = false;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial theme if available
            loadTheme('love-relationship');
            
            // Add some sample search tags for demonstration
            setTimeout(() => {
                currentSearchTags = ['love', 'relationship'];
                updateSearchTags();
                performThemeSearch();
            }, 1000);
        });

        // Auto-complete functionality
        const keywords = ['love', 'work', 'friendship', 'family', 'emotions', 'greetings', 'food', 'travel', 'business', 'comedy', 'drama', 'action'];
        
        document.getElementById('themeSearch').addEventListener('input', function(e) {
            // Simple auto-complete logic would go here
            const value = e.target.value.toLowerCase();
            // In a real implementation, show suggestions
        });
    </script>
</body>
</html>
