<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Theme Search - ÌÖåÎßàÎ≥Ñ Îã§Ï§ë Î¨∏Ïû• Í≤ÄÏÉâ ÏãúÏä§ÌÖú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #0f0f23;
            min-height: 100vh;
            color: #ececf1;
            margin: 0;
            padding: 0;
        }

        /* Ïä§ÌÅ¨Î°§Î∞î Ïà®Í∏∞Í∏∞ */
        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }
        
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
            background: #0f0f23;
            transition: all 0.3s ease;
        }

        /* ChatGPT Style Sidebar */
        .sidebar {
            width: 260px;
            background: #171717;
            color: #ececf1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #2d2d2d;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar.collapsed {
            width: 0;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid #2d2d2d;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-toggle {
            background: transparent;
            border: 1px solid #2d2d2d;
            color: #ececf1;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sidebar-toggle:hover {
            background: #2d2d2d;
        }

        .new-chat-btn {
            flex: 1;
            background: transparent;
            border: 1px solid #2d2d2d;
            color: #ececf1;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-right: 8px;
        }

        .new-chat-btn:hover {
            background: #2d2d2d;
        }

        .sidebar-content {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            max-height: calc(100vh - 80px);
        }

        .search-history {
            margin-bottom: 24px;
        }
        
        .search-history:last-child {
            margin-bottom: 0;
        }

        .search-history h3 {
            font-size: 0.8rem;
            color: #8e8ea0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .history-item {
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 2px;
            font-size: 0.9rem;
            line-height: 1.3;
            color: #e5e5e5;
        }

        .history-item:hover {
            background: #2d2d2d;
        }

        .history-item.active {
            background: #343541;
        }

        /* Main Content Area */
        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .main-header {
            background: white;
            border-bottom: 1px solid #e5e5e5;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 60px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mobile-sidebar-toggle {
            background: transparent;
            border: 1px solid #e5e5e5;
            color: #333;
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }

        .mobile-sidebar-toggle:hover {
            background: #f5f5f5;
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-stats {
            display: flex;
            gap: 20px;
            font-size: 0.8rem;
            color: #666;
        }

        .stat-badge {
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            color: #333;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        /* Search Input Section - Main page style */
        .search-input-section {
            background: white;
            padding: 40px 30px 30px 30px;
            border-bottom: 1px solid #e5e5e5;
            flex-shrink: 0;
        }



        /* Search Input Area - Updated for main page only */
        .search-input-area {
            background: white;
            padding: 40px 30px;
            color: #333;
            border-bottom: 1px solid #e5e5e5;
        }

        .search-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .search-section h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 12px;
            text-align: center;
            color: #333;
        }

        .search-description {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.8;
            line-height: 1.5;
            color: #666;
        }

        .batch-input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e5e5e5;
        }

        .input-label {
            display: block;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .batch-text-input {
            width: 100%;
            min-height: 160px;
            padding: 15px;
            border: 1px solid #e5e5e5;
            border-radius: 10px;
            background: white;
            color: #333;
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }

        .batch-text-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 1px #007bff;
        }

        .batch-text-input::placeholder {
            color: #999;
            font-style: italic;
        }

        .search-options {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .option-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-label {
            font-size: 0.9rem;
            color: #333;
            font-weight: 500;
        }

        .option-select {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            padding: 8px 12px;
            color: #333;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-select:focus {
            outline: none;
            border-color: #007bff;
        }

        .search-actions {
            display: flex;
            gap: 12px;
        }

        .search-btn {
            background: #007bff;
            color: white;
            border: 1px solid #007bff;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .search-btn:hover {
            background: #0056b3;
            border-color: #0056b3;
        }

        .search-btn.secondary {
            background: transparent;
            color: #666;
            border-color: #e5e5e5;
        }

        .search-btn.secondary:hover {
            background: #f5f5f5;
            color: #333;
        }

        /* Search Results - Updated for unified layout */
        .search-results {
            background: white;
            padding: 0 30px 30px 30px;
            overflow-y: auto;
            flex: 1;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px 0 15px 0;
            border-bottom: 1px solid #e5e5e5;
        }

        .results-count {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }

        .view-toggle {
            display: flex;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 4px;
        }

        .view-btn {
            background: none;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #666;
        }

        .view-btn.active {
            background: #007bff;
            color: white;
        }

        .theme-group {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .theme-group:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.15);
        }

        .theme-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .theme-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theme-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .theme-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 8px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .action-btn:hover {
            background: #e9ecef;
            border-color: #ccc;
        }

        .action-btn.primary {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .action-btn.primary:hover {
            background: #5a6fd8;
        }

        .sentences-grid {
            display: grid;
            gap: 15px;
        }

        .sentence-item {
            background: #f8f9ff;
            border: 1px solid #e8e8ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .sentence-item:hover {
            background: #f0f0ff;
            border-color: #667eea;
        }

        .sentence-english {
            font-size: 1rem;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .sentence-korean {
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
        }

        .sentence-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #888;
        }

        .sentence-source {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sentence-actions {
            display: flex;
            gap: 8px;
        }

        .sentence-action {
            background: none;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
        }

        .sentence-action:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        /* Right Sidebar - Theme Board (hidden for ChatGPT style) */
        .theme-board {
            display: none;
        }

        .theme-board h2 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .saved-themes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .saved-theme {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .saved-theme:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .saved-theme.active {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .saved-theme-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .saved-theme-meta {
            font-size: 0.8rem;
            color: #666;
            display: flex;
            justify-content: space-between;
        }

        .quick-themes {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }

        .quick-themes h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .quick-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 15px;
            margin-bottom: 10px;
            width: 100%;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .quick-theme:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* Batch Search Results Styles */
        .search-summary {
            background: #2d2d2d;
            color: #ececf1;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #343541;
        }

        .search-summary h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            color: #ececf1;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .summary-stats .stat-item {
            background: #343541;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #40414f;
        }

        .stat-label {
            display: block;
            font-size: 0.9rem;
            margin-bottom: 5px;
            opacity: 0.8;
            color: #8e8ea0;
        }

        .stat-value {
            display: block;
            font-size: 1.4rem;
            font-weight: 700;
            color: #ececf1;
        }

        .sentence-group {
            background: #2d2d2d;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #343541;
            transition: all 0.3s ease;
        }

        .sentence-group:hover {
            border-color: #10a37f;
        }

        .sentence-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #343541;
        }

        .sentence-header h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin: 0;
            flex: 1;
            margin-right: 15px;
        }

        .result-count {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .sentence-results {
            display: grid;
            gap: 12px;
        }

        .result-card {
            background: #f8f9ff;
            border: 1px solid #e8e8ff;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            background: #f0f0ff;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.85rem;
        }

        .movie-title {
            font-weight: 600;
            color: #333;
        }

        .episode-info {
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            color: #666;
        }

        .timestamp {
            color: #888;
            font-family: monospace;
        }

        .confidence {
            color: #667eea;
            font-weight: 600;
        }

        .result-content {
            margin: 10px 0;
        }

        .subtitle-text {
            font-size: 1rem;
            color: #333;
            line-height: 1.5;
            margin: 0;
            font-style: italic;
        }

        .result-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .result-actions .action-btn {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .result-actions .action-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .result-actions .action-btn.play:hover {
            background: #28a745;
            border-color: #28a745;
        }

        .result-actions .action-btn.clip:hover {
            background: #ffc107;
            border-color: #ffc107;
            color: #333;
        }

        .result-actions .action-btn.save:hover {
            background: #17a2b8;
            border-color: #17a2b8;
        }

        /* Loading and Empty States */
        .loading {
            text-align: center;
            padding: 50px;
            color: #8e8ea0;
        }

        .empty-state {
            text-align: center;
            padding: 50px;
            color: #8e8ea0;
        }

        .empty-state h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #ececf1;
        }

        /* Progress Indicators */
        .progress-bar {
            width: 100%;
            height: 4px;
            background: #f0f0f0;
            border-radius: 2px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #0056b3);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 220px;
            }
            
            .search-input-area {
                padding: 30px 20px;
            }
            
            .search-input-section {
                padding: 30px 20px 20px 20px;
            }
            
            .search-options {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .search-actions {
                justify-content: center;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar:not(.collapsed) {
                transform: translateX(0);
            }
            
            .sidebar.collapsed {
                transform: translateX(-100%);
            }
            
            .mobile-sidebar-toggle {
                display: flex;
            }
            
            .main-area {
                width: 100%;
            }
            
            .search-input-area {
                padding: 20px 15px;
            }
            
            .search-input-section {
                padding: 20px 15px 15px 15px;
            }
            
            .search-section h2 {
                font-size: 1.5rem;
            }
            
            .search-description {
                font-size: 1rem;
            }
            
            .batch-input-section {
                padding: 20px;
            }
            
            .batch-text-input {
                min-height: 120px;
                font-size: 0.9rem;
            }
            
            .search-actions {
                flex-direction: column;
            }
            
            .search-btn {
                width: 100%;
                justify-content: center;
            }
            
            .header-stats {
                display: none;
            }
            
            .search-results {
                padding: 15px;
            }
            
            /* Sidebar Overlay for Mobile */
            .sidebar-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
            }
            
            .sidebar-overlay.active {
                opacity: 1;
                visibility: visible;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .theme-group {
            animation: fadeInUp 0.6s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .search-btn:active {
            animation: pulse 0.3s ease;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ChatGPT Style Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <button class="new-chat-btn" onclick="startNewSearch()">
                    <span>‚ûï</span>
                    <span>ÏÉà ÌÖåÎßà Í≤ÄÏÉâ</span>
                </button>
            </div>
            
            <div class="sidebar-content">
                <div class="search-history">
                    <h3>ÏµúÍ∑º Í≤ÄÏÉâ</h3>
                    <div class="history-item active" onclick="loadHistoryItem('üíï ÏÇ¨ÎûëÍ≥º Í¥ÄÍ≥Ñ ÌëúÌòÑ', 15)">
                        üíï ÏÇ¨ÎûëÍ≥º Í¥ÄÍ≥Ñ ÌëúÌòÑ (15Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üíº ÎπÑÏ¶àÎãàÏä§ ÎØ∏ÌåÖ ÏòÅÏñ¥', 12)">
                        üíº ÎπÑÏ¶àÎãàÏä§ ÎØ∏ÌåÖ ÏòÅÏñ¥ (12Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚òï ÏùºÏÉÅ ÎåÄÌôî ÌëúÌòÑ', 18)">
                        ‚òï ÏùºÏÉÅ ÎåÄÌôî ÌëúÌòÑ (18Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üòä Í∞êÏ†ï ÌëúÌòÑÌïòÍ∏∞', 20)">
                        üòä Í∞êÏ†ï ÌëúÌòÑÌïòÍ∏∞ (20Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üçï ÏùåÏãù Í¥ÄÎ†® ÌëúÌòÑ', 16)">
                        üçï ÏùåÏãù Í¥ÄÎ†® ÌëúÌòÑ (16Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚úàÔ∏è Ïó¨Ìñâ ÏòÅÏñ¥ ÌëúÌòÑ', 22)">
                        ‚úàÔ∏è Ïó¨Ìñâ ÏòÅÏñ¥ ÌëúÌòÑ (22Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üéì ÌïôÍµêÏÉùÌôú ÌëúÌòÑ', 14)">
                        üéì ÌïôÍµêÏÉùÌôú ÌëúÌòÑ (14Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üí™ Ïö¥ÎèôÍ≥º Í±¥Í∞ï', 19)">
                        üí™ Ïö¥ÎèôÍ≥º Í±¥Í∞ï (19Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üé¨ ÏòÅÌôî Î¶¨Î∑∞ ÌëúÌòÑ', 17)">
                        üé¨ ÏòÅÌôî Î¶¨Î∑∞ ÌëúÌòÑ (17Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üõçÔ∏è ÏáºÌïë ÏòÅÏñ¥', 13)">
                        üõçÔ∏è ÏáºÌïë ÏòÅÏñ¥ (13Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üè† ÏßëÏïàÏùº ÌëúÌòÑ', 11)">
                        üè† ÏßëÏïàÏùº ÌëúÌòÑ (11Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üöó ÍµêÌÜµÍ≥º Ïö¥Ï†Ñ', 15)">
                        üöó ÍµêÌÜµÍ≥º Ïö¥Ï†Ñ (15Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üì± Í∏∞Ïà†Í≥º SNS', 21)">
                        üì± Í∏∞Ïà†Í≥º SNS (21Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üéµ ÏùåÏïÖÍ≥º Ï∑®ÎØ∏', 18)">
                        üéµ ÏùåÏïÖÍ≥º Ï∑®ÎØ∏ (18Í∞ú Î¨∏Ïû•)
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('üåÖ ÎÇ†Ïî®ÏôÄ Í≥ÑÏ†à', 12)">
                        üåÖ ÎÇ†Ïî®ÏôÄ Í≥ÑÏ†à (12Í∞ú Î¨∏Ïû•)
                    </div>
                </div>
                
                <div class="search-history">
                    <h3>Ï¶êÍ≤®Ï∞æÍ∏∞</h3>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê TOEIC ÌïÑÏàò ÌëúÌòÑ', 45)">
                        ‚≠ê TOEIC ÌïÑÏàò ÌëúÌòÑ
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê Î©¥Ï†ë ÏòÅÏñ¥ ÌëúÌòÑ', 32)">
                        ‚≠ê Î©¥Ï†ë ÏòÅÏñ¥ ÌëúÌòÑ
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê ÏπúÍµ¨ÏôÄÏùò ÎåÄÌôî', 28)">
                        ‚≠ê ÏπúÍµ¨ÏôÄÏùò ÎåÄÌôî
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò ÏòÅÏñ¥', 36)">
                        ‚≠ê ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò ÏòÅÏñ¥
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê Ïù¥Î©îÏùº ÏûëÏÑ±Î≤ï', 24)">
                        ‚≠ê Ïù¥Î©îÏùº ÏûëÏÑ±Î≤ï
                    </div>
                    <div class="history-item" onclick="loadHistoryItem('‚≠ê Ï†ÑÌôî ÏòÅÏñ¥', 19)">
                        ‚≠ê Ï†ÑÌôî ÏòÅÏñ¥
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Area -->
        <div class="main-area">
            <div class="main-header">
                <div class="header-left">
                    <button class="mobile-sidebar-toggle" onclick="toggleSidebar()" id="sidebarToggle">
                        <span>‚ò∞</span>
                    </button>
                    <div class="header-title">
                        üéØ Theme Search
                        <span style="font-size: 0.8rem; color: #666;">ÌÖåÎßàÎ≥Ñ Îã§Ï§ë Î¨∏Ïû• Í≤ÄÏÉâ</span>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="stat-badge">
                        <span>üìä</span>
                        <span>270K+ Î¨∏Ïû•</span>
                    </div>
                    <div class="stat-badge">
                        <span>üé¨</span>
                        <span>7Í∞ú ÎØ∏ÎîîÏñ¥</span>
                    </div>
                    <div class="stat-badge">
                        <span>‚ö°</span>
                        <span>AI Ï∂îÏ≤ú</span>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <!-- Search Input Section Only -->
                <div class="search-input-section">
                    <div class="search-container">
                        <div class="search-section">
                            <h2>üéØ Î∞∞Ïπò Î¨∏Ïû• Í≤ÄÏÉâ</h2>
                            <p class="search-description">Ïó¨Îü¨ Í∞úÏùò ÏòÅÏñ¥ Î¨∏Ïû•ÏùÑ Ìïú Î≤àÏóê ÏûÖÎ†•ÌïòÏó¨ Í¥ÄÎ†®Îêú ÎØ∏ÎîîÏñ¥ ÏΩòÌÖêÏ∏†Î•º Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî.</p>
                            
                            <div class="batch-input-section">
                                <label for="batchTextInput" class="input-label">
                                    üìù ÏòÅÏñ¥ Î¨∏Ïû•Îì§ ÏûÖÎ†• (Ìïú Ï§ÑÏóê ÌïòÎÇòÏî©)
                                </label>
                                <textarea 
                                    id="batchTextInput" 
                                    class="batch-text-input" 
                                    placeholder="I love you so much.
You make me happy.
How are you doing today?
Can you help me with this?
What do you think about it?

(ÏòÅÏñ¥ Î¨∏Ïû•ÏùÑ Ïó¨Îü¨ Ï§ÑÎ°ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî. ÎåÄÎ¨∏ÏûêÎ°ú ÏãúÏûëÌïòÍ≥† ÎßàÏπ®ÌëúÎ°ú ÎÅùÎÇòÎäî Î¨∏Ïû•ÏùÑ ÏûêÎèôÏúºÎ°ú Ï∂îÏ∂úÌï©ÎãàÎã§.)"
                                    rows="6"></textarea>
                                
                                <div class="search-options">
                                    <div class="option-group">
                                        <label for="resultsPerSentence" class="option-label">Î¨∏Ïû•Îãπ Í≤∞Í≥º Ïàò:</label>
                                        <select id="resultsPerSentence" class="option-select">
                                            <option value="3">3Í∞ú</option>
                                            <option value="5" selected>5Í∞ú</option>
                                            <option value="10">10Í∞ú</option>
                                            <option value="20">20Í∞ú</option>
                                        </select>
                                    </div>
                                    
                                    <div class="search-actions">
                                        <button class="search-btn secondary" onclick="document.getElementById('batchTextInput').value = ''">
                                            üóëÔ∏è Ï¥àÍ∏∞Ìôî
                                        </button>
                                        <button class="search-btn primary" onclick="performBatchSearch()">
                                            üîç Î∞∞Ïπò Í≤ÄÏÉâ ÏãúÏûë
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="searchProgress" class="progress-bar" style="display: none;">
                                    <div class="progress-fill"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Î∞∞Ïπò Îã§Ï§ë Î¨∏Ïû• Í≤ÄÏÉâ Í∏∞Îä•
        function extractEnglishSentences(text) {
            // ÌïúÍ∏Ä, ÌïúÏûê, ÏùºÎ≥∏Ïñ¥ Î¨∏Ïûê Ï†úÍ±∞ (Ïú†ÎãàÏΩîÎìú Î≤îÏúÑ)
            const koreanRegex = /[\u1100-\u11FF\u3130-\u318F\uAC00-\uD7AF\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF]/g;
            
            // 1Îã®Í≥Ñ: ÌïúÍ∏Ä/Ï§ëÍµ≠Ïñ¥/ÏùºÎ≥∏Ïñ¥ Î¨∏ÏûêÍ∞Ä Ìè¨Ìï®Îêú Ï§Ñ Ï†úÍ±∞
            const lines = text.split('\n').filter(line => {
                const cleanLine = line.trim();
                return cleanLine.length > 0 && !koreanRegex.test(cleanLine);
            });
            
            // 2Îã®Í≥Ñ: ÏòÅÏñ¥ Î¨∏Ïû• Ï∂îÏ∂ú (ÎåÄÎ¨∏ÏûêÎ°ú ÏãúÏûëÌïòÍ≥† .?!Î°ú ÎÅùÎÇòÎäî Î¨∏Ïû•)
            const sentences = [];
            const sentenceRegex = /[A-Z][^.!?]*[.!?]/g;
            
            lines.forEach(line => {
                const matches = line.match(sentenceRegex);
                if (matches) {
                    matches.forEach(sentence => {
                        const trimmed = sentence.trim();
                        // ÏµúÏÜå Í∏∏Ïù¥ Ï≤¥ÌÅ¨ (ÎÑàÎ¨¥ ÏßßÏùÄ Î¨∏Ïû• Ï†úÏô∏)
                        if (trimmed.length >= 10 && trimmed.split(' ').length >= 3) {
                            sentences.push(trimmed);
                        }
                    });
                }
            });
            
            return sentences;
        }

        function simulateBatchSearch(sentences, resultsPerSentence) {
            const allResults = [];
            let totalFound = 0;
            
            sentences.forEach((sentence, index) => {
                // Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í≤ÄÏÉâ ÏãúÎÆ¨Î†àÏù¥ÏÖò
                const mockResults = generateMockSearchResults(sentence, resultsPerSentence);
                totalFound += mockResults.length;
                
                allResults.push({
                    searchSentence: sentence,
                    sentenceIndex: index + 1,
                    results: mockResults,
                    found: mockResults.length
                });
            });
            
            return {
                searchedSentences: sentences.length,
                totalResults: totalFound,
                avgPerSentence: (totalFound / sentences.length).toFixed(1),
                results: allResults
            };
        }

        function generateMockSearchResults(sentence, count) {
            const mockData = [
                { movie: "The Office", season: 3, episode: 14, time: "12:34", context: sentence, confidence: 0.95 },
                { movie: "Friends", season: 10, episode: 2, time: "08:22", context: sentence, confidence: 0.89 },
                { movie: "Breaking Bad", season: 2, episode: 7, time: "35:18", context: sentence, confidence: 0.84 },
                { movie: "Stranger Things", season: 1, episode: 4, time: "22:45", context: sentence, confidence: 0.78 },
                { movie: "The Crown", season: 4, episode: 8, time: "41:12", context: sentence, confidence: 0.72 },
                { movie: "Sherlock", season: 2, episode: 1, time: "15:30", context: sentence, confidence: 0.69 },
                { movie: "House of Cards", season: 3, episode: 5, time: "28:56", context: sentence, confidence: 0.65 },
                { movie: "Black Mirror", season: 4, episode: 6, time: "33:21", context: sentence, confidence: 0.61 },
                { movie: "Westworld", season: 1, episode: 9, time: "45:18", context: sentence, confidence: 0.58 },
                { movie: "Game of Thrones", season: 7, episode: 3, time: "52:14", context: sentence, confidence: 0.54 }
            ];
            
            return mockData.slice(0, Math.min(count, mockData.length));
        }

        function performBatchSearch() {
            const batchText = document.getElementById('batchTextInput').value.trim();
            const resultsPerSentence = parseInt(document.getElementById('resultsPerSentence').value);
            
            if (!batchText) {
                alert('Îã§Ï§ë Î¨∏Ïû•ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            // Î°úÎî© ÌëúÏãú
            showSearchProgress();
            
            // Ïã§Ï†ú API Ìò∏Ï∂ú
            fetch('/api/batch-search', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    text: batchText,
                    results_per_sentence: resultsPerSentence
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Í≤ÄÏÉâ ÌûàÏä§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞Ä
                    addToSearchHistory(data.extracted_sentences, data.search_summary.total_results);
                    
                    // ÏÉà ÌéòÏù¥ÏßÄÎ°ú Í≤∞Í≥º Ï†ÑÎã¨
                    redirectToResults(data);
                } else {
                    alert(data.error || 'Í≤ÄÏÉâ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                    // Î∞±ÏóÖÏúºÎ°ú ÏãúÎÆ¨Î†àÏù¥ÏÖò Ïã§Ìñâ
                    performBatchSearchSimulation();
                }
                hideSearchProgress();
            })
            .catch(error => {
                console.error('API Ìò∏Ï∂ú Ïò§Î•ò:', error);
                // ChatGPTÏ≤òÎüº ÏãúÎÆ¨Î†àÏù¥ÏÖòÏúºÎ°ú Î∞îÎ°ú Ïù¥Îèô
                performBatchSearchSimulation();
                hideSearchProgress();
            });
        }

        function performBatchSearchSimulation() {
            const batchText = document.getElementById('batchTextInput').value.trim();
            const resultsPerSentence = parseInt(document.getElementById('resultsPerSentence').value);
            
            // ÏòÅÏñ¥ Î¨∏Ïû• Ï∂îÏ∂ú
            const englishSentences = extractEnglishSentences(batchText);
            
            if (englishSentences.length === 0) {
                alert('ÏòÅÏñ¥ Î¨∏Ïû•ÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. ÎåÄÎ¨∏ÏûêÎ°ú ÏãúÏûëÌïòÍ≥† ÎßàÏπ®ÌëúÎ°ú ÎÅùÎÇòÎäî Î¨∏Ïû•ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            // Î∞∞Ïπò Í≤ÄÏÉâ Ïã§Ìñâ (ÏãúÎÆ¨Î†àÏù¥ÏÖò)
            const searchResults = simulateBatchSearch(englishSentences, resultsPerSentence);
            
            // Í≤ÄÏÉâ ÌûàÏä§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞Ä
            addToSearchHistory(englishSentences, searchResults.totalResults);
            
            // Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
            const resultsData = {
                success: true,
                extracted_sentences: englishSentences,
                search_summary: {
                    total_sentences: searchResults.searchedSentences,
                    total_results: searchResults.totalResults,
                    average_per_sentence: searchResults.avgPerSentence,
                    search_time: 1.2
                },
                sentence_results: searchResults.results.map(r => ({
                    sentence_index: r.sentenceIndex,
                    search_sentence: r.searchSentence,
                    found_count: r.found,
                    results: r.results.map(result => ({
                        media_name: result.movie,
                        subtitle_text: result.context,
                        timestamp: result.time,
                        confidence: result.confidence,
                        file_path: `/${result.movie.toLowerCase().replace(' ', '_')}/s${result.season}e${result.episode}.srt`
                    }))
                }))
            };
            
            // ÏÉà ÌéòÏù¥ÏßÄÎ°ú Í≤∞Í≥º Ï†ÑÎã¨
            redirectToResults(resultsData);
        }

        function addToSearchHistory(sentences, totalResults) {
            const historyItem = {
                timestamp: new Date().toLocaleString('ko-KR'),
                sentences: sentences,
                sentenceCount: sentences.length,
                totalResults: totalResults,
                type: 'batch'
            };
            
            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ï†ÄÏû• (Ïã§Ï†ú Íµ¨ÌòÑÏóêÏÑúÎäî Î∞±ÏóîÎìú API Ìò∏Ï∂ú)
            let searchHistory = JSON.parse(localStorage.getItem('batchSearchHistory') || '[]');
            searchHistory.unshift(historyItem);
            searchHistory = searchHistory.slice(0, 10); // ÏµúÍ∑º 10Í∞úÎßå Ïú†ÏßÄ
            localStorage.setItem('batchSearchHistory', JSON.stringify(searchHistory));
            
            console.log('Í≤ÄÏÉâ ÌûàÏä§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞ÄÎê®:', historyItem);
        }

        // ÏÉà Í≤ÄÏÉâ ÏãúÏûë
        function startNewSearch() {
            // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
            document.getElementById('batchTextInput').value = '';
            
            // ÏÇ¨Ïù¥ÎìúÎ∞îÏùò ÌôúÏÑ± Ìï≠Î™© Ï†úÍ±∞
            document.querySelectorAll('.history-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        // ÌÄµ Í≤ÄÏÉâ Í∏∞Îä• Í∞úÏÑ†
        function quickSearch(themeType) {
            const themeData = {
                'love': {
                    title: 'üíï ÏÇ¨ÎûëÍ≥º Í¥ÄÍ≥Ñ',
                    sentences: [
                        'I love you more than words can express.',
                        'You make me want to be a better person.',
                        'I can\'t imagine my life without you.',
                        'You complete me.',
                        'I\'m crazy about you.'
                    ]
                },
                'business': {
                    title: 'üíº ÎπÑÏ¶àÎãàÏä§ ÏòÅÏñ¥',
                    sentences: [
                        'Let\'s schedule a meeting to discuss this further.',
                        'I need the quarterly reports by tomorrow.',
                        'We should consider all our options.',
                        'Could you please send me the agenda?',
                        'I\'d like to propose a new strategy.'
                    ]
                },
                'daily': {
                    title: '‚òï ÏùºÏÉÅ ÎåÄÌôî',
                    sentences: [
                        'How was your day?',
                        'What do you want for dinner?',
                        'I\'m running late for work.',
                        'The weather is really nice today.',
                        'Did you watch the news last night?'
                    ]
                }
            };
            
            const theme = themeData[themeType];
            if (!theme) return;
            
            // Î°úÎî© ÌëúÏãú
            showSearchProgress();
            
            // ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏßÄÏó∞ ÌõÑ Í≤∞Í≥º ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            setTimeout(() => {
                // ÌÄµ Í≤ÄÏÉâ Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
                const mockResults = theme.sentences.map((sentence, index) => ({
                    sentence_index: index + 1,
                    search_sentence: sentence,
                    found_count: 3 + Math.floor(Math.random() * 3),
                    results: generateMockSearchResults(sentence, 3)
                }));
                
                const resultsData = {
                    success: true,
                    extracted_sentences: theme.sentences,
                    search_summary: {
                        total_sentences: theme.sentences.length,
                        total_results: mockResults.reduce((sum, r) => sum + r.found_count, 0),
                        average_per_sentence: (mockResults.reduce((sum, r) => sum + r.found_count, 0) / theme.sentences.length).toFixed(1),
                        search_time: 0.8
                    },
                    sentence_results: mockResults.map(r => ({
                        sentence_index: r.sentence_index,
                        search_sentence: r.search_sentence,
                        found_count: r.found_count,
                        results: r.results.map(result => ({
                            media_name: result.movie,
                            subtitle_text: result.context,
                            timestamp: result.time,
                            confidence: result.confidence,
                            file_path: `/${result.movie.toLowerCase().replace(' ', '_')}/s${result.season}e${result.episode}.srt`
                        }))
                    }))
                };
                
                // Í≤ÄÏÉâ ÌûàÏä§ÌÜ†Î¶¨Ïóê Ï∂îÍ∞Ä
                addToSearchHistory(theme.sentences, resultsData.search_summary.total_results);
                
                // Í≤∞Í≥º ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
                redirectToResults(resultsData);
                hideSearchProgress();
            }, 1000);
        }

        // Sample data for demonstration
        const sampleThemes = {
            'love-relationship': {
                title: 'üíï ÏÇ¨ÎûëÍ≥º Í¥ÄÍ≥Ñ',
                count: 15,
                sentences: [
                    {
                        english: "I love you more than words can express.",
                        korean: "ÎßêÎ°ú ÌëúÌòÑÌï† Ïàò ÏóÜÏùÑ ÎßåÌÅº ÎãπÏã†ÏùÑ ÏÇ¨ÎûëÌï¥Ïöî.",
                        source: "The Notebook",
                        timestamp: "01:23:45"
                    },
                    {
                        english: "You make me want to be a better person.",
                        korean: "ÎãπÏã†ÏùÄ ÎÇòÎ•º Îçî ÎÇòÏùÄ ÏÇ¨ÎûåÏù¥ ÎêòÍ≥† Ïã∂Í≤å ÎßåÎì§Ïñ¥Ïöî.",
                        source: "As Good as It Gets",
                        timestamp: "02:15:30"
                    },
                    {
                        english: "I can't imagine my life without you.",
                        korean: "ÎãπÏã† ÏóÜÎäî ÎÇ¥ Ïù∏ÏÉùÏùÄ ÏÉÅÏÉÅÌï† Ïàò ÏóÜÏñ¥Ïöî.",
                        source: "Friends S02E07",
                        timestamp: "00:18:22"
                    }
                ]
            },
            'emotions': {
                title: 'üòä Í∞êÏ†ï ÌëúÌòÑ',
                count: 20,
                sentences: [
                    {
                        english: "I'm feeling overwhelmed right now.",
                        korean: "ÏßÄÍ∏à ÎÑàÎ¨¥ Î≤ÖÏ∞®Îäî Í∏∞Î∂ÑÏù¥ÏóêÏöî.",
                        source: "This Is Us S01E03",
                        timestamp: "00:25:18"
                    },
                    {
                        english: "That made me incredibly happy.",
                        korean: "Í∑∏Í≤ÉÏù¥ ÎÇòÎ•º ÏóÑÏ≤≠ÎÇòÍ≤å ÌñâÎ≥µÌïòÍ≤å ÌñàÏñ¥Ïöî.",
                        source: "Friends S05E14",
                        timestamp: "00:12:45"
                    },
                    {
                        english: "I'm really nervous about the presentation.",
                        korean: "Î∞úÌëú ÎïåÎ¨∏Ïóê Ï†ïÎßê Í∏¥Ïû•ÎèºÏöî.",
                        source: "The Office S03E12",
                        timestamp: "00:08:33"
                    }
                ]
            }
        };

        // Search functionality
        function handleSearchKeyPress(event) {
            if (event.key === 'Enter') {
                addSearchTag();
            }
        }

        function addSearchTag() {
            const input = document.getElementById('themeSearch');
            const tag = input.value.trim();
            
            if (tag && !currentSearchTags.includes(tag)) {
                currentSearchTags.push(tag);
                input.value = '';
                updateSearchTags();
            }
        }

        function updateSearchTags() {
            const container = document.getElementById('searchTags');
            container.innerHTML = '';
            
            currentSearchTags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'search-tag';
                tagElement.innerHTML = `
                    <span>${tag}</span>
                    <span class="remove-tag" onclick="removeSearchTag('${tag}')">√ó</span>
                `;
                container.appendChild(tagElement);
            });
        }

        function removeSearchTag(tag) {
            currentSearchTags = currentSearchTags.filter(t => t !== tag);
            updateSearchTags();
        }

        function toggleFilter(button, filter) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }

        function performThemeSearch() {
            if (isSearching) return;
            
            isSearching = true;
            showSearchProgress();
            
            // Simulate API call
            setTimeout(() => {
                displaySearchResults();
                hideSearchProgress();
                isSearching = false;
            }, 2000);
        }

        function showSearchProgress() {
            const progressBar = document.getElementById('searchProgress');
            progressBar.style.display = 'block';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.querySelector('.progress-fill').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 200);
        }

        function hideSearchProgress() {
            setTimeout(() => {
                document.getElementById('searchProgress').style.display = 'none';
                document.querySelector('.progress-fill').style.width = '0%';
            }, 500);
        }

        function displaySearchResults() {
            const container = document.getElementById('searchResultsContainer');
            const resultsCount = document.getElementById('resultsCount');
            
            // Generate results based on search tags
            const themes = generateThemeResults();
            currentThemes = themes;
            
            resultsCount.textContent = `üéØ ${themes.length}Í∞ú ÌÖåÎßà, Ï¥ù ${themes.reduce((sum, theme) => sum + theme.count, 0)}Í∞ú Î¨∏Ïû• Î∞úÍ≤¨`;
            
            container.innerHTML = '';
            
            themes.forEach((theme, index) => {
                const themeElement = createThemeElement(theme, index);
                container.appendChild(themeElement);
            });
        }

        function generateThemeResults() {
            // Simulate theme generation based on search tags
            const themes = [];
            
            if (currentSearchTags.includes('love') || currentSearchTags.includes('relationship')) {
                themes.push({
                    id: 'love-relationship',
                    title: 'üíï ÏÇ¨ÎûëÍ≥º Í¥ÄÍ≥Ñ',
                    count: 15,
                    category: 'romance',
                    difficulty: 'intermediate',
                    sources: ['Friends', 'The Notebook', 'When Harry Met Sally'],
                    sentences: generateSampleSentences('love', 15)
                });
            }
            
            if (currentSearchTags.includes('work') || currentSearchTags.includes('business')) {
                themes.push({
                    id: 'business-work',
                    title: 'üíº ÎπÑÏ¶àÎãàÏä§ÏôÄ ÏóÖÎ¨¥',
                    count: 12,
                    category: 'business',
                    difficulty: 'advanced',
                    sources: ['The Office', 'Mad Men', 'Suits'],
                    sentences: generateSampleSentences('business', 12)
                });
            }
            
            if (currentSearchTags.includes('friend') || currentSearchTags.includes('friendship')) {
                themes.push({
                    id: 'friendship',
                    title: 'üë• Ïö∞Ï†ïÍ≥º ÎèôÎ£å',
                    count: 18,
                    category: 'friendship',
                    difficulty: 'intermediate',
                    sources: ['Friends', 'How I Met Your Mother', 'The Big Bang Theory'],
                    sentences: generateSampleSentences('friendship', 18)
                });
            }
            
            // Default themes if no specific tags
            if (themes.length === 0) {
                themes.push({
                    id: 'daily-conversation',
                    title: '‚òï ÏùºÏÉÅ ÎåÄÌôî',
                    count: 20,
                    category: 'daily',
                    difficulty: 'beginner',
                    sources: ['Friends', 'Modern Family', 'The Office'],
                    sentences: generateSampleSentences('daily', 20)
                });
            }
            
            return themes;
        }

        function generateSampleSentences(category, count) {
            const sentences = {
                love: [
                    { english: "I love you more than words can express.", korean: "ÎßêÎ°ú ÌëúÌòÑÌï† Ïàò ÏóÜÏùÑ ÎßåÌÅº ÎãπÏã†ÏùÑ ÏÇ¨ÎûëÌï¥Ïöî.", source: "The Notebook", timestamp: "01:23:45" },
                    { english: "You make me want to be a better person.", korean: "ÎãπÏã†ÏùÄ ÎÇòÎ•º Îçî ÎÇòÏùÄ ÏÇ¨ÎûåÏù¥ ÎêòÍ≥† Ïã∂Í≤å ÎßåÎì§Ïñ¥Ïöî.", source: "As Good as It Gets", timestamp: "02:15:30" },
                    { english: "I can't imagine my life without you.", korean: "ÎãπÏã† ÏóÜÎäî ÎÇ¥ Ïù∏ÏÉùÏùÄ ÏÉÅÏÉÅÌï† Ïàò ÏóÜÏñ¥Ïöî.", source: "Friends S02E07", timestamp: "00:18:22" }
                ],
                business: [
                    { english: "Let's schedule a meeting to discuss this further.", korean: "Ïù¥Í≤ÉÏóê ÎåÄÌï¥ Îçî ÎÖºÏùòÌïòÍ∏∞ ÏúÑÌï¥ ÌöåÏùòÎ•º Ïû°ÏïÑÎ¥ÖÏãúÎã§.", source: "The Office S03E05", timestamp: "00:12:30" },
                    { english: "I need the quarterly reports by tomorrow.", korean: "ÎÇ¥ÏùºÍπåÏßÄ Î∂ÑÍ∏∞ Î≥¥Í≥†ÏÑúÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§.", source: "Mad Men S02E08", timestamp: "00:25:15" },
                    { english: "We should consider all our options.", korean: "Î™®Îì† ÏÑ†ÌÉùÏÇ¨Ìï≠ÏùÑ Í≥†Î†§Ìï¥Ïïº Ìï©ÎãàÎã§.", source: "Suits S01E12", timestamp: "00:18:45" }
                ],
                friendship: [
                    { english: "I'll always be there for you.", korean: "Ïñ∏Ï†úÎÇò ÎãπÏã† Í≥ÅÏóê ÏûàÏùÑÍ≤åÏöî.", source: "Friends S01E01", timestamp: "00:22:30" },
                    { english: "Thanks for being such a great friend.", korean: "Ïù¥Î†áÍ≤å Ï¢ãÏùÄ ÏπúÍµ¨Í∞Ä ÎêòÏñ¥Ï§òÏÑú Í≥†ÎßàÏõåÏöî.", source: "How I Met Your Mother S03E15", timestamp: "00:19:20" },
                    { english: "We've been through so much together.", korean: "Ïö∞Î¶¨Îäî Ìï®Íªò ÎßéÏùÄ ÏùºÏùÑ Í≤™Ïñ¥ÏôîÏñ¥Ïöî.", source: "The Big Bang Theory S05E10", timestamp: "00:14:55" }
                ],
                daily: [
                    { english: "How was your day?", korean: "Ïò§Îäò ÌïòÎ£® Ïñ¥Îï†Ïñ¥Ïöî?", source: "Friends S01E02", timestamp: "00:05:30" },
                    { english: "What do you want for dinner?", korean: "Ï†ÄÎÖÅÏúºÎ°ú Î≠ò ÎìúÏã§ÎûòÏöî?", source: "Modern Family S02E15", timestamp: "00:08:45" },
                    { english: "I'm running late for work.", korean: "ÏßÅÏû•Ïóê Îä¶ÏùÑ Í≤É Í∞ôÏïÑÏöî.", source: "The Office S01E01", timestamp: "00:03:20" }
                ]
            };
            
            return sentences[category] || sentences.daily;
        }

        function createThemeElement(theme, index) {
            const themeDiv = document.createElement('div');
            themeDiv.className = 'theme-group';
            themeDiv.style.animationDelay = (index * 0.1) + 's';
            
            themeDiv.innerHTML = `
                <div class="theme-header">
                    <div class="theme-title">
                        ${theme.title}
                        <span class="tooltip" data-tooltip="AIÍ∞Ä Î∂ÑÏÑùÌïú ${theme.count}Í∞ú Í¥ÄÎ†® Î¨∏Ïû•">‚ÑπÔ∏è</span>
                    </div>
                    <div class="theme-actions">
                        <button class="action-btn" onclick="saveTheme('${theme.id}')">
                            <span>üíæ</span>
                            <span>Ï†ÄÏû•</span>
                        </button>
                        <button class="action-btn" onclick="exportTheme('${theme.id}')">
                            <span>üì§</span>
                            <span>ÎÇ¥Î≥¥ÎÇ¥Í∏∞</span>
                        </button>
                        <button class="action-btn primary" onclick="startLearning('${theme.id}')">
                            <span>üéØ</span>
                            <span>ÌïôÏäµ ÏãúÏûë</span>
                        </button>
                    </div>
                </div>
                
                <div class="theme-meta">
                    <div class="meta-item">
                        <span>üìä</span>
                        <span>${theme.count}Í∞ú Î¨∏Ïû•</span>
                    </div>
                    <div class="meta-item">
                        <span>üìö</span>
                        <span>${theme.difficulty}</span>
                    </div>
                    <div class="meta-item">
                        <span>üé¨</span>
                        <span>${theme.sources.length}Í∞ú ÏÜåÏä§</span>
                    </div>
                    <div class="meta-item">
                        <span>‚è±Ô∏è</span>
                        <span>ÏòàÏÉÅ ÌïôÏäµÏãúÍ∞Ñ: ${Math.ceil(theme.count * 2.5)}Î∂Ñ</span>
                    </div>
                </div>
                
                <div class="sentences-grid">
                    ${theme.sentences.slice(0, 3).map(sentence => `
                        <div class="sentence-item">
                            <div class="sentence-english">"${sentence.english}"</div>
                            <div class="sentence-korean">"${sentence.korean}"</div>
                            <div class="sentence-meta">
                                <div class="sentence-source">
                                    <span>üé¨</span>
                                    <span>${sentence.source}</span>
                                    <span>‚Ä¢</span>
                                    <span>${sentence.timestamp}</span>
                                </div>
                                <div class="sentence-actions">
                                    <button class="sentence-action" onclick="playAudio('${sentence.source}', '${sentence.timestamp}')">üîä</button>
                                    <button class="sentence-action" onclick="addToFavorites('${sentence.english}')">‚≠ê</button>
                                    <button class="sentence-action" onclick="practiceThis('${sentence.english}')">üéØ</button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                    ${theme.count > 3 ? `
                        <div class="sentence-item" style="text-align: center; color: #667eea; font-weight: 600; cursor: pointer;" onclick="showAllSentences('${theme.id}')">
                            + ${theme.count - 3}Í∞ú Î¨∏Ïû• Îçî Î≥¥Í∏∞
                        </div>
                    ` : ''}
                </div>
            `;
            
            return themeDiv;
        }

        function clearSearch() {
            currentSearchTags = [];
            document.getElementById('themeSearch').value = '';
            updateSearchTags();
            
            // Reset filters
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.filter-btn').classList.add('active');
            
            // Clear results
            document.getElementById('searchResultsContainer').innerHTML = `
                <div class="empty-state">
                    <h3>üéØ ÌÖåÎßà Í≤ÄÏÉâÏùÑ ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî</h3>
                    <p>ÌÇ§ÏõåÎìúÎ•º ÏûÖÎ†•ÌïòÎ©¥ Í¥ÄÎ†®Îêú 10-20Í∞ú Î¨∏Ïû•ÏùÑ ÌÖåÎßàÎ≥ÑÎ°ú Í∑∏Î£πÌôîÌï¥ÎìúÎ¶ΩÎãàÎã§.</p>
                    <p>ÏòàÏãú: "love", "work", "friendship" Îì±</p>
                </div>
            `;
            
            document.getElementById('resultsCount').textContent = 'Í≤ÄÏÉâ Í≤∞Í≥ºÎ•º Í∏∞Îã§Î¶¨Îäî Ï§ë...';
        }

        function switchView(viewType) {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // In a real implementation, this would change the layout
            console.log('Switching to', viewType, 'view');
        }

        // Theme Board Functions
        function loadTheme(themeId) {
            // Remove active class from all saved themes
            document.querySelectorAll('.saved-theme').forEach(theme => {
                theme.classList.remove('active');
            });
            
            // Add active class to clicked theme
            event.target.closest('.saved-theme').classList.add('active');
            
            // Load the theme data
            if (sampleThemes[themeId]) {
                const theme = sampleThemes[themeId];
                currentThemes = [theme];
                displayLoadedTheme(theme);
            }
        }

        function displayLoadedTheme(theme) {
            const container = document.getElementById('searchResultsContainer');
            const resultsCount = document.getElementById('resultsCount');
            
            resultsCount.textContent = `üìã Ï†ÄÏû•Îêú ÌÖåÎßà: ${theme.title} (${theme.count}Í∞ú Î¨∏Ïû•)`;
            
            container.innerHTML = '';
            const themeElement = createThemeElement({
                id: 'loaded-theme',
                title: theme.title,
                count: theme.count,
                category: 'saved',
                difficulty: 'mixed',
                sources: ['Multiple Sources'],
                sentences: theme.sentences
            }, 0);
            
            container.appendChild(themeElement);
        }

        function quickSearch(themeType) {
            currentSearchTags = [themeType];
            updateSearchTags();
            performThemeSearch();
        }

        // Action Functions
        function saveTheme(themeId) {
            alert(`ÌÖåÎßà "${themeId}"Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!`);
        }

        function exportTheme(themeId) {
            alert(`ÌÖåÎßà "${themeId}"Î•º ÎÇ¥Î≥¥ÎÇ¥Îäî Ï§ë... (CSV, JSON, ÌïôÏäµÏûêÎ£å ÌòïÌÉúÎ°ú Í∞ÄÎä•)`);
        }

        function startLearning(themeId) {
            alert(`"${themeId}" ÌÖåÎßàÎ°ú ÌïôÏäµÏùÑ ÏãúÏûëÌï©ÎãàÎã§! ÏâêÎèÑÏúô Î™®ÎìúÎ°ú Ï†ÑÌôòÎê©ÎãàÎã§.`);
        }

        function showAllSentences(themeId) {
            alert(`"${themeId}" ÌÖåÎßàÏùò Î™®Îì† Î¨∏Ïû•ÏùÑ Î≥¥Ïó¨ÎìúÎ¶ΩÎãàÎã§.`);
        }

        function playAudio(source, timestamp) {
            alert(`üîä ${source} ${timestamp} Ïò§ÎîîÏò§Î•º Ïû¨ÏÉùÌï©ÎãàÎã§.`);
        }

        function addToFavorites(sentence) {
            alert(`‚≠ê "${sentence}"Î•º Ï¶êÍ≤®Ï∞æÍ∏∞Ïóê Ï∂îÍ∞ÄÌñàÏäµÎãàÎã§!`);
        }

        function practiceThis(sentence) {
            alert(`üéØ "${sentence}" Î¨∏Ïû•ÏúºÎ°ú ÏâêÎèÑÏúô Ïó∞ÏäµÏùÑ ÏãúÏûëÌï©ÎãàÎã§!`);
        }

        // ÏÇ¨Ïù¥ÎìúÎ∞î ÌûàÏä§ÌÜ†Î¶¨Ïóê ÏÉà Ìï≠Î™© Ï∂îÍ∞Ä
        function addToSidebarHistory(title, sentenceCount) {
            const historyContainer = document.querySelector('.search-history');
            const historyItems = historyContainer.querySelectorAll('.history-item');
            
            // Í∏∞Ï°¥ ÌôúÏÑ± Ìï≠Î™© Ï†úÍ±∞
            historyItems.forEach(item => item.classList.remove('active'));
            
            // ÏÉà Ìï≠Î™© ÏÉùÏÑ±
            const newItem = document.createElement('div');
            newItem.className = 'history-item active';
            newItem.textContent = `${title} (${sentenceCount}Í∞ú Î¨∏Ïû•)`;
            newItem.onclick = () => loadHistoryItem(title, sentenceCount);
            
            // Ï≤´ Î≤àÏß∏ ÏúÑÏπòÏóê Ï∂îÍ∞Ä (h3 Îã§Ïùå)
            const h3 = historyContainer.querySelector('h3');
            h3.insertAdjacentElement('afterend', newItem);
            
            // 15Í∞ú Ïù¥ÏÉÅÏù¥Î©¥ ÎßàÏßÄÎßâ Ìï≠Î™© Ï†úÍ±∞
            const allItems = historyContainer.querySelectorAll('.history-item');
            if (allItems.length > 15) {
                allItems[allItems.length - 1].remove();
            }
        }
        
        // ÌûàÏä§ÌÜ†Î¶¨ Ìï≠Î™© Î°úÎìú
        function loadHistoryItem(title, sentenceCount) {
            // ÌôúÏÑ± ÏÉÅÌÉú Î≥ÄÍ≤Ω
            document.querySelectorAll('.history-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Ìï¥Îãπ Í≤ÄÏÉâ Í≤∞Í≥º ÌëúÏãú (ÏãúÎÆ¨Î†àÏù¥ÏÖò)
            document.getElementById('resultsCount').textContent = `üìã Ï†ÄÏû•Îêú Í≤ÄÏÉâ: ${title} (${sentenceCount}Í∞ú Î¨∏Ïû•)`;
            
            // Í∞ÑÎã®Ìïú Í≤∞Í≥º ÌëúÏãú
            document.getElementById('searchResultsContainer').innerHTML = `
                <div style="text-align: center; padding: 50px; color: #8e8ea0;">
                    <div style="font-size: 2rem; margin-bottom: 20px;">üìÅ</div>
                    <h3 style="color: #ececf1; margin-bottom: 15px;">${title}</h3>
                    <p>Ï¥ù ${sentenceCount}Í∞úÏùò Í¥ÄÎ†® Î¨∏Ïû•Ïù¥ Ï†ÄÏû•ÎêòÏñ¥ ÏûàÏäµÎãàÎã§.</p>
                    <p style="margin-top: 20px; opacity: 0.7;">Ïã§Ï†ú Íµ¨ÌòÑÏóêÏÑúÎäî Ï†ÄÏû•Îêú Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§.</p>
                </div>
            `;
        }

        // Í≤ÄÏÉâ Í≤∞Í≥º ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
        function redirectToResults(data) {
            // Í≤ÄÏÉâ Îç∞Ïù¥ÌÑ∞Î•º URL ÌååÎùºÎØ∏ÌÑ∞Î°ú Ï†ÑÎã¨
            const searchDataParam = encodeURIComponent(JSON.stringify(data));
            window.location.href = `search_results.html?data=${searchDataParam}`;
        }

        // ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜ†Í∏Ä Í∏∞Îä•
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            sidebar.classList.toggle('collapsed');
            
            // Î™®Î∞îÏùºÏóêÏÑúÎäî Ïò§Î≤ÑÎ†àÏù¥ Ï∂îÍ∞Ä/Ï†úÍ±∞
            if (window.innerWidth <= 768) {
                if (!sidebar.classList.contains('collapsed')) {
                    // Ïò§Î≤ÑÎ†àÏù¥ Ï∂îÍ∞Ä
                    const overlay = document.createElement('div');
                    overlay.className = 'sidebar-overlay';
                    overlay.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.5);
                        z-index: 999;
                        opacity: 0;
                        transition: opacity 0.3s ease;
                    `;
                    document.body.appendChild(overlay);
                    
                    // Ïò§Î≤ÑÎ†àÏù¥ ÌÅ¥Î¶≠ Ïãú ÏÇ¨Ïù¥ÎìúÎ∞î Îã´Í∏∞
                    overlay.onclick = toggleSidebar;
                    
                    // Ïï†ÎãàÎ©îÏù¥ÏÖòÏùÑ ÏúÑÌï¥ ÏïΩÍ∞ÑÏùò ÏßÄÏó∞
                    setTimeout(() => {
                        overlay.style.opacity = '1';
                    }, 10);
                } else {
                    // Ïò§Î≤ÑÎ†àÏù¥ Ï†úÍ±∞
                    const overlay = document.querySelector('.sidebar-overlay');
                    if (overlay) {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            overlay.remove();
                        }, 300);
                    }
                }
            }
            
            // Î≤ÑÌäº ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            if (sidebar.classList.contains('collapsed')) {
                sidebarToggle.innerHTML = '<span>‚ò∞</span>';
                sidebarToggle.title = 'ÏÇ¨Ïù¥ÎìúÎ∞î Î≥¥Ïù¥Í∏∞';
            } else {
                sidebarToggle.innerHTML = '<span>‚ò∞</span>';
                sidebarToggle.title = 'ÏÇ¨Ïù¥ÎìúÎ∞î Ïà®Í∏∞Í∏∞';
            }
        }

        // Ï∞Ω ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Ïãú ÏÇ¨Ïù¥ÎìúÎ∞î ÏÉÅÌÉú Ï≤¥ÌÅ¨
        window.addEventListener('resize', function() {
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            
            if (window.innerWidth > 768) {
                // Îç∞Ïä§ÌÅ¨ÌÜ±ÏóêÏÑúÎäî Ïò§Î≤ÑÎ†àÏù¥ Ï†úÍ±∞
                if (overlay) {
                    overlay.remove();
                }
                // Îç∞Ïä§ÌÅ¨ÌÜ±ÏóêÏÑúÎäî ÏÇ¨Ïù¥ÎìúÎ∞îÍ∞Ä Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Î≥¥ÏûÑ
                if (sidebar.classList.contains('collapsed')) {
                    sidebar.classList.remove('collapsed');
                }
            }
        });

        // Ï¥àÍ∏∞ Î°úÎìú Ïãú Î™®Î∞îÏùºÏóêÏÑúÎäî ÏÇ¨Ïù¥ÎìúÎ∞î Ïà®ÍπÄ
        document.addEventListener('DOMContentLoaded', function() {
            if (window.innerWidth <= 768) {
                const sidebar = document.querySelector('.sidebar');
                sidebar.classList.add('collapsed');
            }
        });

        // Global variables
        let currentSearchTags = [];
        let currentThemes = [];
        let isSearching = false;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial theme if available
            loadTheme('love-relationship');
            
            // Add some sample search tags for demonstration
            setTimeout(() => {
                currentSearchTags = ['love', 'relationship'];
                updateSearchTags();
                performThemeSearch();
            }, 1000);
        });

        // Auto-complete functionality
        const keywords = ['love', 'work', 'friendship', 'family', 'emotions', 'greetings', 'food', 'travel', 'business', 'comedy', 'drama', 'action'];
        
        document.getElementById('themeSearch').addEventListener('input', function(e) {
            // Simple auto-complete logic would go here
            const value = e.target.value.toLowerCase();
            // In a real implementation, show suggestions
        });
    </script>
</body>
</html>
